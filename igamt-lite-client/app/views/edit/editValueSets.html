<style id="antiClickjack">body {
    display: none !important;
}</style>
<script type="text/javascript">
    if (self === top) {
        var antiClickjack = document.getElementById("antiClickjack");
        antiClickjack.parentNode.removeChild(antiClickjack);
    } else {
        top.location = self.location;
    }
</script>
<script type="text/ng-template" id="EditValueSets.html">
<div ng-controller="TableListCtrl" ng-init="init()" class="container">
	<div ng-show="loadingSelection" style="text-align: center; padding-top:20px">
    	<i class="fa fa-spinner fa-pulse fa-align-center fa-2x"></i>
	</div>
	<div ng-show="!loadingSelection">
		<div ng-show="table !== null" id="executionPanel">
			<div class="row" style="margin-left:0px; margin-right: 20px">
				<div class="page-header" style="margin-bottom: 20px">
					<span class="header4">Table: {{table.bindingIdentifier}}</span>
					<span class="pull-right">
						<button title="Save Changes" type="button" class="btn btn-sm btn-success"
								ng-disabled="editForm.$invalid || !editForm.$dirty"
                	 			ng-click="save()">
							<span><i class="fa fa-check fa-fw"></i> Save</span>
						</button>
						<button title="Reset Changes" type="button" class="btn btn-sm btn-warning"
								ng-disabled="!editForm.$dirty"
                	        	ng-click="reset()">
							<span><i class="fa fa-times fa-fw"></i> Reset</span>
						</button>
					</span>
				</div>

				<div class="">
                    <tabset>
						<tab>
                            <tab-heading>
                                <i class="fa fa-info-circle fa-fw" aria-hidden="true"></i> Table MetaData
                            </tab-heading>
                            <div style="margin-top: 20px">
							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.tableIndentifier.$invalid}">
        						<label class="col-md-2 control-label">Mapping Indentifier*</label>

        						<div class="controls col-md-10">
            						<input type="text" name="tableIndentifier" class="form-control" ng-model="table.bindingIdentifier" required ng-change="setDirty()">
        						</div>
    						</div>

							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.name.$invalid}">
        						<label class="col-md-2 control-label">Name*</label>

        						<div class="controls col-md-10">
            						<input type="text" disabled name="name" class="form-control" ng-model="table.name" required ng-change="setDirty()">
        						</div>
    						</div>

							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.decription.$invalid}">
        						<label class="col-md-2 control-label">Description</label>

        						<div class="controls col-md-10">
            						<input type="text" name="description" class="form-control" ng-model="table.description" ng-change="setDirty()">
        						</div>
    						</div>


							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.oid.$invalid}">
        						<label class="col-md-2 control-label">OID</label>

        						<div class="controls col-md-10">
            						<input type="text" name="oid" class="form-control" ng-model="table.oid" ng-change="setDirty()">
        						</div>
    						</div>

							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.version.$invalid}">
        						<label class="col-md-2 control-label">Version</label>

        						<div class="controls col-md-10">
            						<input type="text" name="version" class="form-control" ng-model="table.version" ng-change="setDirty()">
        						</div>
    						</div>

							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.extensibility.$invalid}">
        						<label class="col-md-2 control-label">Extensibility</label>

        						<div class="controls col-md-10">
									<select class="form-control" name="extensibility" ng-model="table.extensibility" ng-options="extensibility for extensibility in config.tableExtensibilities" ng-change="setDirty()"/>
        						</div>
    						</div>

							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.stability.$invalid}">
        						<label class="col-md-2 control-label">Stability</label>

        						<div class="controls col-md-10">
									<select class="form-control" name="stability" ng-model="table.stability" ng-options="stability for stability in config.tableStabilities" ng-change="setDirty()"/>
        						</div>
    						</div>

							<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.contentDefinition.$invalid}">
        						<label class="col-md-2 control-label">Content Definition</label>

        						<div class="controls col-md-10">
									<select class="form-control" name="contentDefinition" ng-model="table.contentDefinition" ng-options="contentDefinition for contentDefinition in config.tableContentDefinitions" ng-change="setDirty()"/>
        						</div>
    						</div>

							<div class="form-group control-group">
        						<label class="col-md-2 control-label">Code Systems*</label>

								<div class="controls col-md-10">
								 	<div class="form-control">
										<span ng-repeat="cs in codeSystems">
											<span ng-hide="codeSysEditMode">{{cs}}</span>
											<input ng-model="cs"  type="text" ng-show="codeSysEditMode"/>
											<a ng-click="delCodeSystem(cs)" ng-show="codeSysEditMode" class="point">
                                        		<span><i class="fa fa-times-circle fa-fw"></i></span>
                                        	</a>
											<span ng-hide="$last">,</span>
										</span>
										<div class="pull-right">
											<a ng-click="makeCodeSystemEditable()" ng-hide="codeSysEditMode" class="point">
                        						<span><i class="fa fa-pencil fa-fw"></i></span>
                    						</a>
											<input ng-model="codeSysForm.str" placeholder="type new codeSystem"  type="text" ng-show="codeSysEditMode"/>
                    						<a ng-click="addCodeSystem()" ng-show="codeSysEditMode" class="point">
                        						<span><i class="fa fa-plus-circle fa-fw"></i></span>
                    						</a>
										</div>
									</div>
								</div>
							</div>
                                </div>
						</tab>
						
						<tab>
                            <tab-heading>
                                <i class="fa fa-table fa-fw" aria-hidden="true"></i> Table Definition
                            </tab-heading>

							<div class="el-def" style="margin-top: 20px">
								<div>
									<span class="pull-right">
										<button title="Add new Value" type="button" class="btn btn-sm btn-info" ng-click="addValue();">
											<span><i class="fa fa-plus fa-fw"></i>&nbsp; Add Value</span>
										</button>
									</span>
								</div>

								<div class="">
									<div class="table-responsive">
										<table st-safe-src="table.codes" st-table="displayCollection"  class="table table-striped">
											<thead>
											<tr>
												<th st-sort="value">Value</th>
												<th st-sort="label">Description</th>
												<th>CodeSystem</th>
												<th>Usage</th>
												<th>Action</th>
											</tr>

											<tr>
												<th>
													<input st-search="'value'" placeholder="search for value" class="input-sm form-control" type="search"/>
												</th>
												<th>
													<input st-search="'label'" placeholder="search for description" class="input-sm form-control" type="search"/>
												</th>
												<th>
													<select class="form-control"
															name="setALLCodeSystem"
															ng-change="updateCodeSystem(table,codeSystem)"
															ng-model="codeSystem"
															ng-options="cs for cs in codeSystems">
													</select>
												</th>
												<th>
													<div class="btn-group btn-group-xs btn-info" role="group" aria-label="...">
														<button type="button" ng-click="setAllCodeUsage(table, 'R')" class="btn btn-default btn-info">R</button>
														<button type="button" ng-click="setAllCodeUsage(table, 'P')" class="btn btn-default btn-info">P</button>
														<button type="button" ng-click="setAllCodeUsage(table, 'E')" class="btn btn-default btn-info">E</button>
													</div>
												</th>
												<th>
												</th>
											</tr>
											</thead>

											<tbody>
											<tr ng-repeat="c in displayCollection">
												<td class="col-md-3">
													<div ng-show="isDuplicatedTwoContexts(c,'value', 'codeSystem', table.codes)">
														<input type="text" style="width: 100%" name="Value"
															   ng-change="setDirty()"
															   class="form-control-warning"
															   ng-model="c.value"/>
														<span style="color:red">Duplicated</span>
													</div>
													<div ng-hide="isDuplicatedTwoContexts(c,'value', 'codeSystem', table.codes)">
														<input type="text" style="width: 100%" name="Value"
															   ng-change="setDirty()"
															   class="form-control"
															   ng-model="c.value"/>
													</div>
												</td>

												<td class="col-md-4">
													<div ng-show="isDuplicatedTwoContexts(c,'label', 'codeSystem' , table.codes)">
														<input type="text" style="width: 100%" name="Label"
															   ng-change="setDirty()"
															   class="form-control-warning"
															   ng-model="c.label"/>
														<span style="color:red">Duplicated</span>
													</div>

													<div ng-hide="isDuplicatedTwoContexts(c,'label', 'codeSystem' , table.codes)">
														<input type="text" style="width: 100%" name="Label"
															   ng-change="setDirty()"
															   class="form-control"
															   ng-model="c.label"/>
													</div>
												</td>

												<td class="col-md-2">
													<div ng-show="!c.codeSystem || c.codeSystem === ''">
														<select class="form-control-warning"
																ng-change="setDirty()"
																ng-model="c.codeSystem"
																ng-options="cs for cs in codeSystems">
														</select>
														<span style="color:red">Missing CodeSystem</span>
													</div>
													<div ng-hide="!c.codeSystem || c.codeSystem === ''">
														<select class="form-control"
																ng-change="setDirty()"
																ng-model="c.codeSystem"
																ng-options="cs for cs in codeSystems">
														</select>
													</div>
												</td>
												<td class="col-md-2">
													<select class="form-control" name="Usage"
															ng-change="setDirty()"
															ng-model="c.codeUsage"
															ng-options="codeUsage for codeUsage in config.codeUsages">
													</select>
												</td>

												<td class="col-md-1">
													<button title="Delete" type="button" class="btn btn-xs btn-danger" ng-click="deleteValue(c)">
														<i class="fa fa-trash-o fa-fw"></i>
													</button>
												</td>
											</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</tab>
					</tabset>
				</div>
			</div>
		</div>
	</div>
</div>
</script>

<script type="text/ng-template" id="ReadValueSets.html">
	<div ng-controller="TableListCtrl" ng-init="init()" class="container">
		<div ng-show="loadingSelection" style="text-align: center; padding-top:20px">
			<i class="fa fa-spinner fa-pulse fa-align-center fa-2x"></i>
		</div>
		<div ng-show="!loadingSelection">
			<div ng-show="table !== null" id="executionPanel">
				<div class="row" style="margin-left:0px; margin-right: 20px">
					<div class="page-header" style="margin-bottom: 20px">
						<span class="header4">Table: {{table.bindingIdentifier}}</span>
					</div>

					<div class="">
						<tabset>
							<tab>
								<tab-heading>
									<i class="fa fa-info-circle fa-fw" aria-hidden="true"></i> Table MetaData
								</tab-heading>
								<div style="margin-top: 20px">
									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.tableIndentifier.$invalid}">
										<label class="col-md-2 control-label">Mapping Indentifier</label>

										<div class="controls col-md-10">
											<input type="text" disabled name="tableIndentifier" class="form-control" ng-model="table.bindingIdentifier" required ng-change="setDirty()">
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.name.$invalid}">
										<label class="col-md-2 control-label">Name</label>

										<div class="controls col-md-10">
											<input type="text" disabled name="name" class="form-control" ng-model="table.name" required ng-change="setDirty()">
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.decription.$invalid}">
										<label class="col-md-2 control-label">Description</label>

										<div class="controls col-md-10">
											<input type="text" disabled name="description" class="form-control" ng-model="table.description" ng-change="setDirty()">
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.decription.$invalid}">
										<label class="col-md-2 control-label">Description</label>

										<div class="controls col-md-10">
											<input type="text" disabled name="description" class="form-control" ng-model="table.description" ng-change="setDirty()">
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.oid.$invalid}">
										<label class="col-md-2 control-label">OID</label>

										<div class="controls col-md-10">
											<input type="text" disabled name="oid" class="form-control" ng-model="table.oid" ng-change="setDirty()">
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.version.$invalid}">
										<label class="col-md-2 control-label">Version</label>

										<div class="controls col-md-10">
											<input type="text" disabled name="version" class="form-control" ng-model="table.version" ng-change="setDirty()">
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.extensibility.$invalid}">
										<label class="col-md-2 control-label">Extensibility</label>

										<div class="controls col-md-10">
											<select class="form-control" disabled name="extensibility" ng-model="table.extensibility" ng-options="extensibility for extensibility in config.tableExtensibilities" ng-change="setDirty()"/>
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.stability.$invalid}">
										<label class="col-md-2 control-label">Stability</label>

										<div class="controls col-md-10">
											<select class="form-control" disabled name="stability" ng-model="table.stability" ng-options="stability for stability in config.tableStabilities" ng-change="setDirty()"/>
										</div>
									</div>

									<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.contentDefinition.$invalid}">
										<label class="col-md-2 control-label">Content Definition</label>

										<div class="controls col-md-10">
											<select class="form-control" disabled name="contentDefinition" ng-model="table.contentDefinition" ng-options="contentDefinition for contentDefinition in config.tableContentDefinitions" ng-change="setDirty()"/>
										</div>
									</div>

									<div class="form-group control-group">
										<label class="col-md-2 control-label">Code Systems</label>

										<div class="controls col-md-10">
											<div class="form-control">
												<span ng-repeat="cs in codeSystems">
													<span ng-hide="codeSysEditMode">{{cs}}</span>
													<span ng-hide="$last">,</span>
												</span>
											</div>
										</div>
									</div>
								</div>
							</tab>

							<tab>
								<tab-heading>
									<i class="fa fa-table fa-fw" aria-hidden="true"></i> Table Definition
								</tab-heading>

								<div class="el-def">
									<div class="">
										<div class="table-responsive">
											<table st-safe-src="table.codes" st-table="displayCollection"  class="table table-striped">


												<thead>
												<tr>
													<th st-sort="value">Value</th>
													<th st-sort="label">Description</th>
													<th>CodeSystem</th>
													<th>Usage</th>
													<th>Action</th>
												</tr>

												<tr>
													<th>
														<input st-search="'value'" placeholder="search for value" class="input-sm form-control" type="search"/>
													</th>
													<th>
														<input st-search="'label'" placeholder="search for description" class="input-sm form-control" type="search"/>
													</th>
													<th>
													</th>
													<th>
													</th>
													<th>
													</th>
												</tr>
												</thead>

												<tbody>
												<tr ng-repeat="c in displayCollection">
													<td class="col-md-3">
														<span>{{c.value}}</span>
													</td>

													<td class="col-md-4">
														<span>{{c.label}}</span>
													</td>

													<td class="col-md-2">
														<span>{{c.codeSystem}}</span>
													</td>
													<td class="col-md-2">
														<span>{{c.codeUsage}}</span>
													</td>

													<td class="col-md-1">
													</td>
												</tr>
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</tab>
						</tabset>
					</div>
				</div>
			</div>
		</div>
	</div>
</script>


<script type="text/ng-template" id="ConfirmValueSetDeleteCtrl.html">
    <div class="modal-header">
        <h3 class="modal-title">Delete Confirmation</h3>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to delete Table {{tableToDelete.bindingIdentifier}} ? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>

<script type="text/ng-template" id="ValueSetReferencesCtrl.html">
    <div class="modal-header">
        <h3 class="modal-title">Table References Found
            <button class="btn btn-primary btn-xs pull-right" ng-click="ok()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Close</span>
            </button>
        </h3>
    </div>
    <div class="modal-body">
        <p>We cannot delete this table because it is being referenced by elements below:</p>

        <div class="igl-table">
            <table class="table table-striped table-bordered">
                <thead>
                <tr class="tbl-header">
                    <th>Name</th>
                    <th>Path</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="ref in references">
                    <td>
                                        <span>
                                              <img style="width:15px; height:15px"
                                                   ng-src="images/{{ref.type}}.png">
                                             <span style="width:60%"
                                                   name="name"
                                                   ng-bind="ref.name"></span>
                                             <span ng-bind="ref.description"></span>
                                         </span>

                    </td>
                    <td>
                        <div>{{ref.path}}</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!--<div class="modal-footer">-->
        <!--<button class="btn btn-primary" ng-click="ok()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Close</span>-->
        <!--</button>-->
    <!--</div>-->
</script>


