<style id="antiClickjack">
    body {
        display: none !important;
    }
</style>
<script type="text/javascript">
    if (self === top) {
        var antiClickjack = document.getElementById("antiClickjack");
        antiClickjack.parentNode.removeChild(antiClickjack);
    } else {
        top.location = self.location;
    }
</script>
<script type="text/ng-template" id="EditMessages.html">
    <div ng-controller="MessageListCtrl" ng-init="init()">
        <div ng-show="loadingSelection" style="text-align: center;">
            <i class="fa fa-spinner fa-pulse fa-align-center fa-4x"></i>
        </div>
        <div ng-show="!loadingSelection">
            <div ng-show="message !== null" id="executionPanel">
                <div class="row" style="margin-left:0px; margin-right: 10px">
                    <div class="page-header" style="margin-bottom: 20px">
                        <span class="header4">Conformance Profile: {{message.name}} </span>
                        <span class="pull-right">
                            <button title="Save Changes" type="button" class="btn btn-raised btn-sm btn-success"
                                    ng-disabled="editForm.$invalid ||!editForm.$dirty"
                                    ng-hide="viewSettings.tableReadonly" ng-click="save()">
                                <span><i class="fa fa-check fa-fw"></i> Save</span>
                        </button>
                        <button title="Cancel Changes" type="button" class="btn btn-raised btn-sm btn-warning" ng-hide="viewSettings.tableReadonly" ng-disabled="!editForm.$dirty" ng-click="reset()">
                            <span><i class="fa fa-times fa-fw"></i> Reset</span>
                        </button>
                        </span>
                    </div>
                    <div class="col-md-12" ng-controller="cmpMessageCtrl">
                        <tabset active="tabStatus.active">
                            <tab>
                                <tab-heading>
                                    <i class="fa fa-info-circle fa-fw" aria-hidden="true"></i> Conformance Profile MetaData
                                </tab-heading>
                                <div style="margin-top: 20px">
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.name.$invalid}">
                                        <label class="col-md-2 control-label">Name*</label>
                                        <div class="controls col-md-10">
                                            <input class="form-control" type="text" disabled name="name" ng-change="setDirty()" ng-model="message.name" ng-disabled="viewSettings.tableReadonly">
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.identifier.$invalid}">
                                        <label class="col-md-2 control-label">Identifier*</label>
                                        <div class="controls col-md-10">
                                            <input type="text" ng-change="setDirty()" name="identifier" class="form-control" ng-model="message.identifier" ng-disabled="viewSettings.tableReadonly" required>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.description.$invalid}">
                                        <label class="col-md-2 control-label">Description</label>
                                        <div class="controls col-md-10">
                                            <input class="form-control" type="text" name="description" ng-change="setDirty()" ng-model="message.description" ng-disabled="viewSettings.tableReadonly">
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.description.$invalid}">
                                        <label class="col-md-2 control-label">Hl7 Version</label>
                                        <div class="controls col-md-10">
                                            <input class="form-control" type="text" name="hl7Version" ng-model="message.hl7Version" disabled>
                                        </div>
                                    </div>
                                    <!--<div class="form-group control-group"-->
                                    <!--ng-class="{'igl-has-error' : editForm.messageOId.$invalid}">-->
                                    <!--<label class="col-md-2 control-label">Message OID</label>-->
                                    <!--<div class="controls col-md-10"><input type="text" disabled name="messageOId"-->
                                    <!--class="form-control"-->
                                    <!--ng-model="message.messageID" required></div>-->
                                    <!--</div>-->
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.messageType.$invalid}">
                                        <label class="col-md-2 control-label">Message Type*</label>
                                        <div class="controls col-md-10">
                                            <input type="text" disabled name="messageType" class="form-control" ng-model="message.messageType" required>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.messageEvent.$invalid}">
                                        <label class="col-md-2 control-label">Message Event*</label>
                                        <div class="controls col-md-10">
                                            <input type="text" disabled name="messageEvent" class="form-control" ng-model="message.event" required ng-disabled="false">
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.messageStructID.$invalid}">
                                        <label class="col-md-2 control-label">Message Structure ID*</label>
                                        <div class="controls col-md-10">
                                            <input type="text" disabled name="messageStructID" class="form-control" ng-model="message.structID" required>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error' : editForm.comment.$invalid}">
                                        <label class="col-md-2 control-label">Comment</label>
                                        <div class="controls col-md-10">
                                            <textarea rows="3" cols="20" ng-disabled="viewSettings.tableReadonly" ng-change="recordDatatypeChange('message','edit',message.id,'message', message.comment)" name="comment" id="comment" class="form-control" ng-model="message.comment" />
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : datatypeForm.text.$invalid}">
                                        <label class="col-md-2 control-label">Definition Text</label>
                                        <div class="controls col-md-10">
                                            <div ng-show="!viewSettings.tableReadonly">
                                                <textarea froala="froalaEditorOptions" ng-model="message.usageNote" name="text" id="text" ng-change="setDirty()"></textarea>
                                            </div>
                                            <div ng-show="viewSettings.tableReadonly">
                                                <div class="fr-view">
                                                    <div froala-view="message.usageNote"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group control-group">
                                        <label class="col-md-2 control-label">Date Updated</label>

                                        <div class="controls col-md-10">
                                            <span
                                                    class="form-control">{{message.dateUpdated | date:dateFormat}}</span>
                                        </div>
                                    </div>

                                </div>
                            </tab>
                            <tab heading="Conformance Profile Definition">
                                <tab-heading>
                                    <i class="fa fa-table fa-fw" aria-hidden="true"></i> Conformance Profile Definition
                                </tab-heading>
                                <div class="el-def" style="margin-top: 5px">
                                    <accordion>
                                        <div accordion-group class="panel-primary" is-open="accordStatus.isFirstOpen">
                                            <accordion-heading>
                                                <span style="color:white;"> Conformance Profile Definition</span> <i class="pull-left fa" style="color:white;" ng-class="{ 'fa-chevron-down': accordStatus.isFirstOpen, 'fa-chevron-right': !accordStatus.isFirstOpen}"></i>                                                </accordion-heading>
                                            <div class="igl-def-table-container">
                                                <span class="pull-left">
                                                    <div style="" ng-dropdown-multiselect=""
                                                        options="viewSettings.columnOptions"
                                                        selected-model="viewSettings.visibleColumns"
                                                        events="viewSettings.events" extra-settings="viewSettings.extra"
                                                        translation-texts="viewSettings.translations">
                                                    </div>
                                                </span>
                                                <span class="pull-right" ng-show="!viewSettings.tableReadonly">
                                                    <div class="btn-group">
                                                        <button type="button" class="btn btn-raised btn-sm btn-info">
                                                            <span><i class="fa fa-plus"></i> Add</span>
                                                        </button>
                                                        <button type="button" class="btn btn-raised btn-sm btn-info" data-toggle="dropdown" aria-expanded="false">
                                                            <span class="caret"></span>
                                                            <span class="sr-only">Toggle Dropdown</span>
                                                        </button>
                                                        <ul class="dropdown-menu igl-menu" role="menu">
                                                            <li><a class="point" ng-click="addSegmentModal(message)"><i class="fa fa-plus fa-fw"></i> Add Segment</a></li>
                                                            <li><a class="point" ng-click="addGroupModal(message)"><i class="fa fa-plus fa-fw"></i> Add Group</a></li>
                                                        </ul>
                                                    </div>
                                                </span>
                                                <table id="messageTable" tt-table tt-params="messagesParams" class="table table-bordered table-fix-header table-condensed profile-table">
                                                    <thead>
                                                        <tr class="tbl-header" style="">
                                                            <th class="col-md-2 col-fixed-250">Name</th>
                                                            <th class="col-md-1 col-fixed-80">Usage
                                                                <button type="button" ng-show="(message.scope === 'USER') && !viewSettings.tableReadonly && (message.children.length>0)" class="btn btn-raised btn-info btn-xs" ng-click="OtoX(message)">O to X</button>
                                                            </th>
                                                            <th class="col-md-1 col-fixed-100">Cardinality</th>
                                                            <th class="col-md-1 col-fixed-100">Length</th>
                                                            <th class="col-md-1 col-fixed-80">ConfLength</th>
                                                            <th class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">Data Type</th>
                                                            <th class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">Value Set</th>
                                                            <th class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">Predicate</th>
                                                            <th class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">Conformance Statement</th>
                                                            <th class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">Definition Text</th>
                                                            <th class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">Comment</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div accordion-group class="panel-primary" is-open="accordStatus.isSecondOpen">
                                            <accordion-heading>
                                                <span style="color:white;">Global Conformance Statements</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isSecondOpen, 'fa-chevron-right': !accordStatus.isSecondOpen}"></i>
                                            </accordion-heading>
                                            <div class="panel-body">
                                                <span class="pull-right">
                                                    <button title="Add/Edit Global Conformance Statements" type="button" class="btn btn-raised btn-sm btn-success" ng-hide="viewSettings.tableReadonly" ng-click="openAddGlobalConformanceStatementDialog(message)">
                                                        <span><i class="fa fa-check fa-fw"></i> Add/Edit Global Conformance Statements</span>
                                                    </button>
                                                </span>
                                                <div class="col-md-12">
                                                    <span ng-hide="listGlobalConformanceStatements.length > 0">No Global Conformance statement</span>
                                                    <div ng-repeat="node in listGlobalConformanceStatements">
                                                        <span ng-show="node.type =='group'">Group : {{node.name}}</span>
                                                        <span ng-show="node.type =='message'">Message : {{node.name}}</span>
                                                        <table st-table="displayed" st-safe-src="node.conformanceStatements" class="table table-striped table-bordered">
                                                            <thead>
                                                                <tr class="tbl-header">
                                                                    <th st-sort="constraintId" class="col-md-2">ID</th>
                                                                    <th class="col-md-10">Description</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="c in displayed">
                                                                    <td class="col-md-2">{{c.constraintId}}</td>
                                                                    <td class="col-md-10">{{c.description}}</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div accordion-group class="panel-primary" is-open="accordStatus.isThirdOpen">
                                            <accordion-heading>
                                                <span style="color:white;">Global Conditional Predicates</span> <i class="pull-left fa" style="color:white;" ng-class="{ 'fa-chevron-down': accordStatus.isThirdOpen, 'fa-chevron-right': !accordStatus.isThirdOpen}"></i>                                        </accordion-heading>
                                            </accordion-heading>
                                            <div class="panel-body">
                                                <div class="col-md-12">
                                                    <span ng-hide="listGlobalPredicates.length > 0">No Global Predicate</span>
                                                    <div ng-repeat="node in listGlobalPredicates">
                                                        <span ng-show="node.type =='group'">Group : {{node.name}}</span>
                                                        <span ng-show="node.type =='message'">Message : {{node.name}}</span>
                                                        <table st-table="displayed" st-safe-src="node.predicates" class="table table-striped table-bordered">
                                                            <thead>
                                                            <tr class="tbl-header">
                                                                <th st-sort="constraintTarget" class="col-md-2">Target</th>
                                                                <th class="col-md-8">Description</th>
                                                                <th class="col-md-1">True Usage</th>
                                                                <th class="col-md-1">False Usage</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            <tr ng-repeat="c in displayed">
                                                                <td class="col-md-2">{{c.constraintTarget}}</td>
                                                                <td class="col-md-8">{{c.description}}</td>
                                                                <td class="col-md-1">{{c.trueUsage}}</td>
                                                                <td class="col-md-1">{{c.falseUsage}}</td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </accordion>
                                </div>
                            </tab>
                            <tab ng-click="callMsgDelta()">
                                <tab-heading>
                                    <i class="fa fa-table fa-fw" aria-hidden="true"></i> Conformance Profile Delta
                                </tab-heading>
                                <div class="panel-body" style="margin:5px;">
                                    <accordion>
                                        <div accordion-group class="panel-primary" is-open="status.isFirstOpen">
                                            <accordion-heading>
                                                <span style="color:white;"> Delta Configuration</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': status.isFirstOpen, 'fa-chevron-right': !status.isFirstOpen}"></i>
                                            </accordion-heading>
                                            <table class="table table-stripped table-borderless table-condensed">
                                                <thead>
                                                <tr class="tbl-header">
                                                    <th class="col-md-1"></th>
                                                    <th class="col-md-2">HL7 Version</th>
                                                    <th class="col-md-2">Scope</th>
                                                    <th class="col-md-3">IG Document</th>
                                                    <th class="col-md-4">Message</th>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <td class="col-md-1">
                                                        <span class="label" style="background-color:#B5F7EC;color:black;">1</span>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="version1" class="form-control" disabled>
                                                            <option ng-selected="version1"> {{::version1}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="scope1" class="form-control" disabled>
                                                            <option ng-selected="scope1"> {{::scope1}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-3">
                                                        <select ng-model="ig1" class="form-control" disabled>
                                                            <option ng-selected="ig1"> {{::ig1}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-4">
                                                        <select ng-model="message1" class="form-control" disabled>
                                                            <option ng-selected="message1"> {{message1.name}}</option>
                                                        </select>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="col-md-1">
                                                        <span class="label" style="background-color:#EDE1AF;color:black;">2</span>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="version2" class="form-control" ng-change="setVersion2(version2)" no-dirty-check>
                                                            <option ng-repeat="vr in versions" value='{{vr}}' ng-selected="vr===version2"> {{::vr}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="scope2" class="form-control" ng-change="setScope2(scope2)" no-dirty-check>
                                                            <option ng-repeat="scope in scopes" value='{{scope.name}}' ng-selected="scope.name===scope2"> {{::scope.alias}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-3">
                                                        <select class="form-control" ng-options="ig as ig.title for ig in igList2 track by ig.id" ng-model="ig2" ng-click="setIG2(ig2)" ng-disabled="!scope2 || !version2 || igDisabled2" no-dirty-check></select>
                                                    </td>
                                                    <td class="col-md-4">
                                                        <select ng-model="message2" class="form-control" ng-change="setMsg2(message2)" ng-disabled="!ig2" no-dirty-check>
                                                            <option ng-repeat="message in messages2 track by message.id"  ng-disabled="disableMsg(message,message1)" ng-hide="hideMsg(message,message1)" value='{{message}}'> {{::message.name}}</option>
                                                        </select>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                            <div class="" align="center" style="margin-bottom:10px">
                                                <button ng-click="cmpMessage(message1,message2)" ng-disabled="!message1 || !message2||!msgChanged" class="btn btn-raised btn-info btn-md"><i class="fa fa-check"></i> Delta</button>
                                            </div>
                                        </div>
                                        <div accordion-group class="panel-primary" is-open="status.isSecondOpen">
                                            <accordion-heading>
                                                <span style="color:white;"> Delta Result</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': status.isSecondOpen, 'fa-chevron-right': !status.isSecondOpen}"></i> </accordion-heading>
                                            <div class="panel-body">
                                                <table tt-table tt-params="dynamicMsg_params" class=" table-marginless table-bordered table-condensed">
                                                    <thead>
                                                    <tr class="tbl-header">
                                                        <th class="col-md-1" rowspan="2" style="width:14%;">Position</th>
                                                        <th class="col-md-2" rowspan="2" style="width:37%;">Name</th>
                                                        <th class="col-md-1" rowspan="2" style="width:2%">Usage</th>
                                                        <th class="col-md-1" colspan="2" style="width:4%">Cardinality</th>
                                                        <th class="col-md-1" colspan="2" style="width:4%">Length</th>
                                                        <th class="col-md-1" rowspan="2" style="width:2%">Conformance Length</th>
                                                        <th class="col-md-1" rowspan="2" style="width:21%">Data Type</th>
                                                        <th class="col-md-1" rowspan="2" style="width:16%">Value Set</th>
                                                    </tr>
                                                    <tr class="tbl-header">
                                                        <th class="col-md-1 col-fixed-10" style="width:2%">min</th>
                                                        <th class="col-md-1 col-fixed-10" style="width:2%">max</th>
                                                        <th class="col-md-1 col-fixed-10" style="width:2%">min</th>
                                                        <th class="col-md-1 col-fixed-10" style="width:2%">max</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </accordion>
                                </div>
                            </tab>
                        </tabset>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/ng-template" id="MessageEditTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)">
        <td class="col-md-2 col-fixed-250">
            <span>{{node.obj.event}}^{{node.obj.structID}}:{{node.obj.description}}</span>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
         </td>
    </tr>
</script>

<script type="text/ng-template" id="MessageSegmentRefEditTree.html">

    <tr tt-node is-branch="hasChildren(node.obj)" ng-show="(isVisible(node.obj) &&( node.obj.usage==='R' ||node.obj.usage==='RE' ||node.obj.usage==='C' )&& $root.usageF) || (isVisible(node.obj) && !$root.usageF)">
        <td class="col-md-2 col-fixed-250">
            <a ng-show="editableSeg!==node.obj.id" ng-click="editSgmt(node,message)" class="point">
                <span><i class="fa fa-pencil fa-fw"></i></span>
            </a>
            <a ng-show="editableSeg!==node.obj.id" ng-click="deleteSeg(node)" class="point">
                <span><i class="glyphicon glyphicon-trash"></i></span>
            </a>
            <ng-form class="form-inline">
                <span id="segEditTree" class="label label-segment label-icon">S</span>

                <a ng-show="editableSeg!==node.obj.id" ng-click="redirectSeg(node.obj.ref)" class="point">
                {{getSegmentRefNodeName(node.obj)}}
            </a>

                <select ng-show="editableSeg===node.obj.id" ng-model="position" ng-change="selectPos(node,position)" style="width:15%" class="form-control input-sm">
                    <option ng-repeat="child in $root.segParent.children "  ng-selected="node.obj.position===child.position"> {{child.position}}
                </select>
                <select ng-show="editableSeg===node.obj.id" ng-model="segmentRef" ng-change="selectSeg(node,segmentRef)" style="width:40%" class="form-control input-sm">
                    <option ng-repeat="segmentRef in tmpResults" value="{{segmentRef}}"  ng-selected="node.obj.ref.id===segmentRef.id"> {{getSegmentLabel(segmentRef)}} {{::segmentRef.hl7Version}}
                </select>
                <div align="center">

                    <a ng-show="editableSeg===node.obj.id" ng-click="backSeg()">
                        <span><i align="center" class="glyphicon glyphicon-remove"></i></span>
                    </a>
                </div>
            </ng-form>
        </td>
        <td class="col-md-1 col-fixed-80">
            <div>
                <span ng-show="node.obj.usage !=='C' || (node.obj.usage==='C' && countPredicate(node.path)===0 )">
                    <select class="form-control input-sm" name="usage" ng-change="setDirty(); openPredicateDialog(node); setCardinalities(node);" required
                            ng-model="node.obj.usage" ng-options="usage for usage in config.usages"/>
                </span>
                <div ng-show="node.obj.usage==='C' && countPredicate(node.path) !==0">
                    <p ng-show="findPredicateByPath(node.path)">
                        C({{findPredicateByPath(node.path).trueUsage}}/{{findPredicateByPath(node.path).falseUsage}})
                    </p>
                    <a ng-click="deletePredicateByPath(node.path, message)" class="point">
                        <span title="Delete Predicate and Change Usage"><i class="fa fa-times fa-fw"></i></span>
                    </a>
                </div>
            </div>
        </td>

        <td class="col-md-1 col-fixed-100">
            <div ng-controller="MessageRowCtrl">
                <span ng-form name="{{formName}}" class="form-inline">
                                                <input style="width:45%" class="form-control"
                                                       name="min"
                                                       ng-change="setDirty()"
                                                       ng-pattern="/^\d+$/"
                                                       ng-class="{ 'has-error' : {{formName}}.min.$invalid}"
                                                       ng-model="node.obj.min" required ng-minlength="1">
                                                <input style="width:45%" class="form-control" type="text"
                                                       name="max"
                                                       ng-change="setDirty()"
                                                       ng-class="{ 'has-error' : {{formName}}.max.$invalid}"
                                                       ng-pattern="/^\d+$|^\*?$/"
                                                       ng-model="node.obj.max" required>
                                            </span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-1" ng-style="predWidthx" ng-class="{'has-error': node.obj.usage === 'C' && countPredicate(node.path) != 1}" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <div ng-show="countPredicate(node.path)===0 && node.obj.usage==='C'">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" class="point">
                        <span><i class="fa fa-plus fa-fw"></i></span>
                        <p class="warning" style="color:red;">Need predicate</p>
                    </a>
                </div>
                <div ng-show="countPredicate(node.path) !==0 && node.obj.usage==='C'">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" tooltip-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-append-to-body="true" class="point" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></a>
                </div>
            </div>

        </td>

        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <!--<div>-->
                <!--<div ng-repeat="constraint in filteredConstraints=( message.conformanceStatements | filter:{constraintTarget:node.path}:true)">-->
                    <!--<a ng-click="manageConformanceStatement(node, message)" tooltip-html="getConformanceStatementAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(constraint)" tooltip-trigger tooltip-animation="false"-->
                        <!--tooltip-placement="left"></a>-->
                <!--</div>-->
                <!--<div ng-hide="filteredConstraints.length">-->
                    <!--<a ng-click="manageConformanceStatement(node, message)" class="point">-->
                        <!--<span><i class="fa fa-plus fa-fw"></i></span>-->
                    <!--</a>-->
                <!--</div>-->
            <!--</div>-->
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">

        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <a ng-click="openInputTextDlg(node.obj, 'comment','Comment', false)" class="point" tooltip-html="node.obj.comment" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-pencil fa-fw" ng-show="node.obj.comment !== '' && node.obj.comment !== null"></i>
                <i class="fa fa-plus fa-fw" ng-show="node.obj.comment === '' || node.obj.comment === null"></i>
            </a>
            <a ng-click="clearComments(node.obj,'comment')" ng-show="node.obj.comment !== '' && node.obj.comment !== null">
                <i class="fa fa-times fa-fw"></i>
            </a>


        </td>
    </tr>
</script>

<script type="text/ng-template" id="MessageGroupEditTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)" ng-show="(isVisible(node.obj) && (node.obj.usage==='R' ||node.obj.usage==='C' ||node.obj.usage==='RE' ) && $root.usageF) || (isVisible(node.obj) && !$root.usageF)">
        <td class="col-md-2 col-fixed-250" context-menu="segOption">
            <a ng-show="editableGrp!==node.obj.id" ng-click="editGrp(node,message)" class="point">
                <span><i class="fa fa-pencil fa-fw"></i></span>
            </a>
            <a ng-show="editableGrp!==node.obj.id" ng-click="deleteSeg(node)" class="point">
                <span><i class="glyphicon glyphicon-trash"></i></span>
            </a>
            <ng-form class="form-inline">
                <span class="label label-success label-icon">G</span>
                <span ng-show="editableGrp===node.obj.id">
                    <select ng-show="editableGrp===node.obj.id" ng-model="position" ng-change="selectPos()"  style="width:15%" class="form-control input-sm">
                        <option ng-repeat="child in $root.segParent.children"  ng-selected="node.obj.position===child.position"> {{child.position}}
                    </select>
                    <input style="width:55%" class="form-control"  ng-model="grpName" type="text"/>
                 </span>
                <span ng-show="editableGrp!==node.obj.id" context-menu="segOption" ng-bind="getGroupNodeName(node.obj)" />
                <div align="center">
                    <a ng-show="editableGrp===node.obj.id && grpName" ng-click="applyGrp(node,grpName,position)" class="point">
                        <span><i class="glyphicon glyphicon-ok"></i></span>
                    </a>
                    <a ng-show="editableGrp===node.obj.id" ng-click="backGrp()" class="point">
                        <span><i class="glyphicon glyphicon-remove"></i></span>
                    </a>
                </div>
            </ng-form>
        </td>
        <td class="col-md-1 col-fixed-80">
            <div>
                <span ng-show="node.obj.usage !=='C' || (node.obj.usage==='C' && countPredicate(node.path)===0 )">
                    <select class="form-control input-sm" name="usage" ng-change="setDirty(); openPredicateDialog(node); setCardinalities(node);" required
                            ng-model="node.obj.usage" ng-options="usage for usage in config.usages"/>
                </span>
                <div ng-show="node.obj.usage==='C' && countPredicate(node.path) !==0">
                    <p ng-show="findPredicateByPath(node.path)">
                        C({{findPredicateByPath(node.path).trueUsage}}/{{findPredicateByPath(node.path).falseUsage}})
                    </p>
                    <a ng-click="deletePredicateByPath(node.path, message)" class="point">
                        <span title="Delete Predicate and Change Usage"><i class="fa fa-times fa-fw"></i></span>
                    </a>
                </div>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100">
            <div ng-controller="MessageRowCtrl" class="form-inline">
                <span ng-form name="{{formName}}">
                    <input style="width:45%" class="form-control"
                           name="min"
                           ng-change="setDirty()"
                           ng-pattern="/^\d+$/"
                           ng-class="{ 'has-error' : {{formName}}.min.$invalid}"
                           ng-model="node.obj.min" required ng-minlength="1"/>
                    <input style="width:45%" class="form-control" type="text"
                           name="max"
                           ng-change="setDirty()"
                           ng-class="{ 'has-error' : {{formName}}.max.$invalid}"
                           ng-pattern="/^\d+$|^\*?$/"
                           ng-model="node.obj.max" required/>
                </span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <div ng-show="countPredicate(node.path)===0 && node.obj.usage==='C'">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" class="point">
                        <span><i class="fa fa-plus fa-fw"></i></span>
                        <p class="warning" style="color:red;">Need predicate</p>
                    </a>
                </div>
                <div ng-show="countPredicate(node.path) !==0 && node.obj.usage==='C'">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" tooltip-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-append-to-body="true" class="point" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></a>
                </div>
            </div>
        </td>

        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div>
                <div ng-repeat="constraint in filteredConstraints=( message.conformanceStatements | filter:{constraintTarget:node.path}:true)">
                    <a ng-click="manageConformanceStatement(node, message)" class="point" tooltip-html="getConformanceStatementAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(constraint)" tooltip-trigger
                        tooltip-animation="false" tooltip-placement="left"></a>
                </div>
                <!--<div ng-hide="filteredConstraints.length">-->
                    <!--<a ng-click="manageConformanceStatement(node, message)" class="point">-->
                        <!--<span><i class="fa fa-plus fa-fw"></i></span>-->
                    <!--</a>-->
                <!--</div>-->
            </div>
        </td>

        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>

        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">

            <a ng-click="openInputTextDlg(node.obj, 'comment','Comment', false)" class="point" tooltip-html="node.obj.comment" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-pencil fa-fw" ng-show="node.obj.comment !== '' && node.obj.comment !== null"></i>
                <i class="fa fa-plus fa-fw" ng-show="node.obj.comment === '' || node.obj.comment === null"></i>
            </a>
            <a ng-click="clearComments(node.obj,'comment')" ng-show="node.obj.comment !== '' && node.obj.comment !== null">
                <i class="fa fa-times fa-fw"></i>
            </a>
        </td>
    </tr>
</script>

<script type="text/ng-template" id="MessageFieldViewTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)" ng-show="isVisibleInner(node.obj, parentsMap[node.obj.id])">
        <td class="col-md-2 col-fixed-250">
            <span class="label label-field label-icon" ng-show="node.obj.type==='field'">F</span>
            <span class="label label-sub-component label-icon" ng-show="node.obj.type==='subcomponent'">S</span>
            <span class="label label-component label-icon" ng-show="node.obj.type==='component'">C</span>

            <span tooltip-html="getFieldNodeName(node.obj)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getFieldNodeName(node.obj)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <span>{{::node.obj.usage}}</span>
            <span ng-repeat="p in parentsMap[node.obj.id].predicates  | filter:{constraintTarget:node.obj.position + '[1]'}:true">
                ({{::p.trueUsage}}/{{::p.falseUsage}})
            </span>
            <span ng-show="findPredicateByPath(node.path)">({{::findPredicateByPath(node.path).trueUsage}}/{{::findPredicateByPath(node.path).falseUsage}})</span>
         </td>
        <td class="col-md-1 col-fixed-100">
            <span>[{{::node.obj.min}},{{::node.obj.max}}]</span>
        </td>
        <td class="col-md-1 col-fixed-100" ng-class="{'emptyCol':datatypesMap[node.obj.datatype.id].components.length >0}">
            <span ng-show="datatypesMap[node.obj.datatype.id].components.length  == 0">[{{::node.obj.minLength}},{{::node.obj.maxLength}}]</span>
        </td>
        <td class="col-md-1 col-fixed-80" ng-class="{'emptyCol':datatypesMap[node.obj.datatype.id].components.length >0}">
            <span ng-show="datatypesMap[node.obj.datatype.id].components.length  == 0">{{::node.obj.confLength}}</span>
        </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            <span class="point" ng-click="redirectDT(node.obj.datatype)">{{getDatatypeLabel(node.obj.datatype)}}</span>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">
            <div>
                <span ng-show="node.obj.tables !=undefined && node.obj.tables !=null">
                    <a class="point" ng-repeat="table in node.obj.tables track by table.id" ng-click="redirectVS(table)">{{getTableLabel(tablesMap[table.id])}}</a>
                </span>
            </div>
        </td>
        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div ng-show="viewSettings.tableReadonly">
                <p tooltip-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></p>
            </div>
            <p ng-repeat="constraint in filteredSubConstraints=( parentsMap[node.obj.id].predicates | filter:{constraintTarget:node.obj.position + '[1]'}:true)" tooltip-html="getPredicateAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(constraint)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></p>
            <div ng-show="!viewSettings.tableReadonly">
                <div ng-show="findPredicateByPath(node.path)">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" tooltip-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></a>
                </div>
                <div ng-hide="findPredicateByPath(node.path) || filteredSubConstraints.length || viewSettings.tableReadonly || node.obj.usage !=='C'">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" class="point">
                        <span><i class="fa fa-plus fa-fw"></i></span>
                        <p class="warning" style="color:red;">Need predicate</p>
                    </a>
                </div>
            </div>
        </td>
        <td class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div>
                <p ng-repeat="constraint in parentsMap[node.obj.id].conformanceStatements  | filter:{constraintTarget:node.obj.position + '[1]'}:true" tooltip-html="getConformanceStatementAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip"
                    ng-bind-html="getConstraintAsId(constraint)" tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
            <a ng-show="node.obj.text !=='' && node.obj.text !==null" ng-click="openRichTextDlg(node.obj, 'text', 'Definition Text', true)" class="point">
                <i class="fa fa-eye fa-fw" ></i>
            </a>
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <a ng-click="openInputTextDlg(node.obj, 'comment','Comment', true)" class="point" ng-show="node.obj.comment !== '' && node.obj.comment !== null" tooltip-html="node.obj.comment" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" tooltip-trigger
                tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ng-show="node.obj.comment !== '' && node.obj.comment !== null"></i>
            </a>
        </td>
    </tr>
</script>

<script type="text/ng-template" id="MessageComponentViewTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)" ng-show="isVisibleInner(node.obj, parentsMap[node.obj.id])">
        <td class="col-md-2 col-fixed-250">
            <span>
                <span class="label label-field label-icon" ng-show="node.obj.type==='field'">F</span>
            <span class="label label-sub-component label-icon" ng-show="node.obj.type==='subcomponent'">S</span>
            <span class="label label-component label-icon" ng-show="node.obj.type==='component'">C</span>
            <span ng-bind="getComponentNodeName(node.obj)">
                </span>
            </span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <span>{{::node.obj.usage}}</span>
            <span ng-repeat="p in parentsMap[node.obj.id].predicates  | filter:{constraintTarget:node.obj.position + '[1]'}:true">
                ({{::p.trueUsage}}/{{::p.falseUsage}})
            </span>
            <span ng-show="findPredicateByPath(node.path)">({{::findPredicateByPath(node.path).trueUsage}}/{{::findPredicateByPath(node.path).falseUsage}})</span>
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
        </td>
        <td class="col-md-1 col-fixed-100" ng-class="{'emptyCol':datatypesMap[node.obj.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.obj.datatype.id].components.length  == 0">
                [{{::node.obj.minLength}},{{::node.obj.maxLength}}]
            </div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-class="{'emptyCol':datatypesMap[node.obj.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.obj.datatype.id].components.length  == 0" ng-bind="::node.obj.confLength">
            </div>
        </td>

        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            <span class="point" ng-click="redirectDT(node.obj.datatype)">{{getDatatypeLabel(node.obj.datatype)}}</span>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">
            <div>
                <span ng-show="node.obj.tables !=undefined && node.obj.tables !=null">
                    <a class="point" ng-repeat="table in node.obj.tables track by table.id" ng-click="redirectVS(table)">{{getTableLabel(tablesMap[table.id])}}</a>
                </span>
            </div>
        </td>

        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div ng-show="viewSettings.tableReadonly">
                <p tooltip-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></p>
            </div>
            <p ng-repeat="constraint in filteredSubConstraints=( parentsMap[node.obj.id].predicates | filter:{constraintTarget:node.obj.position + '[1]'}:true)" tooltip-html="getPredicateAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(constraint)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></p>
            <div ng-show="!viewSettings.tableReadonly">
                <div ng-show="findPredicateByPath(node.path)">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" tooltip-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(findPredicateByPath(node.path))" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></a>
                </div>
                <div ng-hide="findPredicateByPath(node.path) || filteredSubConstraints.length || viewSettings.tableReadonly || node.obj.usage !=='C'">
                    <a ng-click="openAddGlobalPredicateDialog(node, message)" class="point">
                        <span><i class="fa fa-plus fa-fw"></i></span>
                        <p class="warning" style="color:red;">Need predicate</p>
                    </a>
                </div>
            </div>
        </td>
        <td class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div>
                <p ng-repeat="constraint in parentsMap[node.obj.id].conformanceStatements | filter:{constraintTarget:node.obj.position + '[1]'}:true" tooltip-html="getConformanceStatementAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(constraint)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></p>
            </div>
        </td>

        <td class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">
            <a ng-show="node.obj.text !=='' && node.obj.text !==null" ng-click="openRichTextDlg(node.obj, 'text', 'Definition Text', true)" class="point">
                <i class="fa fa-eye fa-fw" ></i>
            </a>
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <a ng-click="openInputTextDlg(node.obj, 'comment','Comment', true)" class="point" ng-show="node.obj.comment !== '' && node.obj.comment !== null" tooltip-html="node.obj.comment" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ng-show="node.obj.comment !== '' && node.obj.comment !== null"></i>
            </a>
        </td>
    </tr>
</script>

<script type="text/ng-template" id="GlobalPredicateCtrl.html">
    <div class="modal-header">
        <div>
            <h3 class="header4">Global Predicate for {{::selectedNode.locationPath}}({{::selectedNode.path}})</h3>
        </div>
    </div>

    <div class="modal-body">
        <form role="form">
            <div class="col-md-12">
                <div class="panel panel-default" data-drop="true"  data-jqyoui-options ng-model="predicateData" jqyoui-droppable="{beforeDrop: 'beforePredicateDrop', onDrop: 'afterPredicateDrop'}">
                    <div class="panel-heading">Selected Node Info</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <div class="col-md-6">
                            <div class="form-group control-group">
                                <label class="col-md-2 control-label">Name</label>
                                <div class="controls col-md-10">
                                    <input class="form-control" type="text" disabled ng-model="selectedNode.obj.name">
                                </div>
                            </div>
                            <div class="form-group control-group">
                                <label class="col-md-2 control-label">Path</label>
                                <div class="controls col-md-10">
                                    <input class="form-control" type="text" disabled ng-model="selectedNode.locationPath">
                                </div>
                            </div>
                            <div class="form-group control-group">
                                <label class="col-md-2 control-label">Position Path</label>
                                <div class="controls col-md-10">
                                    <input class="form-control" type="text" disabled ng-model="selectedNode.path">
                                </div>
                            </div>
                            <div class="form-group control-group">
                                <button ng-show="existingPredicate" class="btn btn-raised btn-danger btn-xs" ng-click="deletePredicate()"><span><i class="fa fa-trash fa-fw">&nbsp; </i>Dismiss the current Predicate</span></button>
                                <span ng-show="!existingPredicate" style="color:red;">No Predicate</span>
                            </div>

                        </div>
                        <div class="col-md-6">
                            <div ng-show="existingPredicate">
                                <div class="form-group control-group">
                                    <label class="col-md-2 control-label">Predicate Context</label>
                                    <div class="controls col-md-10">
                                        <input class="form-control" type="text" disabled ng-model="existingContext.name">
                                    </div>
                                </div>
                                <div class="form-group control-group">
                                    <label class="col-md-2 control-label">Predicate Description</label>
                                    <div class="controls col-md-10">
                                        <input class="form-control" type="text" ng-change="setChanged()" ng-model="existingPredicate.description">
                                    </div>
                                </div>
                                <div class="form-group control-group">
                                    <label class="col-md-2 control-label">Predicate Assertion</label>
                                    <div class="controls col-md-10">
                                        <input class="form-control" type="text" ng-change="setChanged()" ng-model="existingPredicate.assertion">
                                    </div>
                                </div>
                                <div class="form-group control-group">
                                    <label class="col-md-2 control-label">True/False Usage</label>
                                    <div class="col-md-5">
                                        <select class="form-control" ng-class="{'form-control-invalid': !existingPredicate.trueUsage}" ng-change="setChanged()" ng-model="existingPredicate.trueUsage" ng-options="usage for usage in config.conditionalUsage" />
                                        <span style="color:red;" ng-show="!existingPredicate.trueUsage">Empty true usage</span>
                                    </div>
                                    <div class="col-md-5">
                                        <select class="form-control" ng-class="{'form-control-invalid': !existingPredicate.falseUsage}" ng-change="setChanged()" ng-model="existingPredicate.falseUsage" ng-options="usage for usage in config.conditionalUsage" />
                                        <span style="color:red;" ng-show="!existingPredicate.falseUsage">Empty true usage</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6" style="margin-top: 10px">
                <div class="panel panel-default">
                    <div class="panel-heading">Full Message</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <table class="table table-striped">
                            <tbody ng-repeat="data in treeDataForMessage" ng-include="'message_tree_Predicate_item.html'">
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-6" style="margin-top: 10px">
                <div class="panel panel-default" data-drop="true"  data-jqyoui-options ng-model="treeDataForContext" jqyoui-droppable="{beforeDrop: 'beforeContextDrop', onDrop: 'afterContextDrop'}">
                    <div class="panel-heading">Selected Context</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <div ng-show="draggingStatus == 'MessageTreeNodeDragging'">
                            <span style="color:red;" class="blink_me">You can drop here!!</span>
                        </div>
                        <div ng-show="treeDataForContext.length > 0">
                            <table class="table table-striped">
                                <tbody ng-repeat="data in treeDataForContext" ng-include="'context_tree_item.html'">
                                </tbody>
                            </table>
                        </div>
                        <div ng-show="treeDataForContext.length == 0">
                            <span style="color:red;">No Selected Context</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12" style="margin-top: 10px">
                <div class="panel panel-default">
                    <div class="panel-heading">List of constraints for selected Context</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <table st-table="displayed" st-safe-src="tempPredicates" class="table table-striped table-bordered">
                            <thead>
                            <tr class="tbl-header">
                                <th class="col-md-1">Draggable</th>
                                <th class="col-md-10">Description (
                                    <input type="checkbox" ng-model="viewAssertion"> view assertion )
                                </th>
                                <th class="col-md-1"></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="c in displayed">
                                <td class="col-md-1" align="center">
                                    <i class="glyphicon glyphicon-move cursorMove" data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="c" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingPredicate({nodeData: data})'}"></i>
                                </td>
                                <td class="col-md-10">
                                    <input class="form-control" ng-model="c.description" type="text" />
                                    <input ng-show="viewAssertion" class="form-control" ng-model="c.assertion"  type="text"/>
                                </td>
                                <td class="col-md-1" align="center">
                                    <button class="btn btn-raised btn-danger btn-xxs" ng-click="deleteTempPredicate(c)"><span><i class="fa fa-trash fa-fw">&nbsp; </i>Del</span></button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <span class="pull-right">
                    <div class="btn-group btn-group-sm" data-toggle="buttons">
                        <label class="btn btn-raised btn-primary btn-xs" ng-click="constraintType = 'Free';" ng-class="{'active':constraintType === 'Free'}">
                            <input type="radio" ng-value="constraintType">Add new Free-Text Predicate
                        </label>
                        <label class="btn btn-raised btn-primary btn-xs" ng-click="constraintType = 'Plain';" ng-class="{'active':constraintType === 'Plain'}">
                            <input type="radio" ng-value="constraintType">Add New Plain Predicate
                        </label>
                        <label class="btn btn-raised btn-primary btn-xs" ng-click="constraintType = 'Complex';" ng-class="{'active':constraintType === 'Complex'}">
                            <input type="radio" ng-value="constraintType">Add New Complex Predicate
                        </label>
                    </div>
                </span>
            </div>

            <div class="col-md-12">
                <table class="table table-striped table-bordered" ng-show="constraintType === 'Free'">
                    <thead>
                    <tr class="tbl-header">
                        <th class="col-md-10">Free-Text (Not supported by validation tool)</th>
                        <th class="col-md-2"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-10">
                            <input class="form-control" ng-model="newConstraint.freeText" type="text" />
                        </td>
                        <td class="col-md-2" align="center">
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="initPredicate()"><span><i class="fa fa-refresh fa-fw">&nbsp; </i>Reset</span></button>
                            <button class="btn btn-raised btn-primary btn-xxs" ng-click="addFreeTextPredicate();"><span><i class="fa fa-plus fa-fw">&nbsp; </i>Add</span></button>
                        </td>
                    </tr>
                    </tbody>
                </table>



                <table class="table table-striped table-bordered" ng-show="constraintType === 'Plain'">
                    <thead>
                    <tr class="tbl-header">
                        <th class="col-md-2">If</th>
                        <th class="col-md-2">Node</th>
                        <th class="col-md-2">Verb</th>
                        <th class="col-md-2">Constraint Pattern</th>
                        <th class="col-md-2">Value</th>
                        <th class="col-md-2"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-2">If</td>
                        <td class="col-md-2" data-drop="true"  data-jqyoui-options ng-model="firstNodeData" jqyoui-droppable="{beforeDrop: 'beforeNodeDrop', onDrop: 'afterNodeDrop'}">
                            <div ng-show="draggingStatus == 'ContextTreeNodeDragging'">
                                <span style="color:red;" class="blink_me">You can drop here!!</span>
                            </div>
                            <div ng-show="newConstraint.location_1">
                                <span>
                                    <span ng-repeat="info in newConstraint.pathInfoSet_1">
                                        <span ng-show="$index == 1 && info.isInstanceNumberEditable">
                                            {{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateFirstPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index == 1 && !info.isInstanceNumberEditable">
                                            {{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index > 1 && info.isInstanceNumberEditable">
                                            .{{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateFirstPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index > 1 && !info.isInstanceNumberEditable">
                                            .{{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index == newConstraint.pathInfoSet_1.length - 1">
                                            ({{info.nodeName}})
                                        </span>
                                    </span>
                                </span>
                            </div>
                            <div ng-show="!newConstraint.location_1">
                                <span style="color:red;">Drop the node!</span>
                            </div>
                        </td>
                        <td class="col-md-2">
                            <select class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintVerb(newConstraint)}" ng-model="newConstraint.verb" ng-options="conditionalConstraintVerb for conditionalConstraintVerb in config.conditionalConstraintVerbs | orderBy:'toString()'" />
                            <span style="color:red;" ng-show="isEmptyConstraintVerb(newConstraint)">Empty verb</span>
                        </td>
                        <td class="col-md-2">
                            <select class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintPattern(newConstraint)}" ng-model="newConstraint.contraintType" ng-options="contraintType for contraintType in config.constraintTypes | orderBy:'toString()'" />
                            <span style="color:red;" ng-show="isEmptyConstraintPattern(newConstraint)">Empty constraint pattern</span>
                        </td>
                        <td class="col-md-2"
                            ng-hide="newConstraint.contraintType == 'identical to another node' ||
                                     newConstraint.contraintType == 'equal to another node' ||
                                     newConstraint.contraintType == 'not-equal to another node' ||
                                     newConstraint.contraintType == 'greater than another node' ||
                                     newConstraint.contraintType == 'equal to or greater than another node' ||
                                     newConstraint.contraintType == 'less than another node' ||
                                     newConstraint.contraintType == 'equal to or less than another node'">
                            <span ng-show="newConstraint.contraintType == 'a literal value' ||
                                           newConstraint.contraintType == 'equal to' ||
                                           newConstraint.contraintType == 'not-equal to' ||
                                           newConstraint.contraintType == 'greater than' ||
                                           newConstraint.contraintType == 'equal to or greater than' ||
                                           newConstraint.contraintType == 'less than' ||
                                           newConstraint.contraintType == 'equal to or less than'">
                                <input class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintValue(newConstraint)}" ng-model="newConstraint.value" type="text"/>
                                <span ng-show="newConstraint.contraintType == 'a literal value'">Case Insensitive: </span>
                                <input ng-show="newConstraint.contraintType == 'a literal value'" type="checkbox" ng-model="newConstraint.ignoreCase" />
                                <span style="color:red;" ng-show="isEmptyConstraintValue(newConstraint)">Empty value</span>
                            </span>
                            <span ng-show="newConstraint.contraintType == 'one of list values'">
                                <input class="form-control"
                                       ng-class="{'form-control-invalid': isEmptyConstraintValue(newConstraint)}"
                                       ng-model="newConstraint.value"
                                       placeholder="Comma-Separated Values(CSV)"
                                       type="text"/>
                                <span style="color:red;" ng-show="isEmptyConstraintValue(newConstraint)">Empty list value</span>
                            </span>
                            <span ng-show="newConstraint.contraintType == 'formatted value'">
                                <select class="form-control"
                                        ng-class="{'form-control-invalid': isEmptyConstraintValue(newConstraint)}"
                                        ng-model="newConstraint.value"
                                        ng-options="predefinedFormat for predefinedFormat in config.predefinedFormats | orderBy:'toString()'"/>
                                <div ng-show="newConstraint.value === 'Regular expression'">
                                    <input class="form-control"
                                           ng-class="{'form-control-invalid': isEmptyConstraintValue2(newConstraint)}"
                                           ng-model="newConstraint.value2" placeholder="Regular expression" type="text"/>
                                </div>
                                <span style="color:red;" ng-show="isEmptyConstraintValue(newConstraint)">Empty format</span>
                                <span style="color:red;" ng-show="newConstraint.value === 'Regular expression' && isEmptyConstraintValue2(newConstraint)">Empty regular expression</span>
                            </span>
                            <span ng-show="newConstraint.contraintType == 'one of codes in ValueSet'">
                                <span>ValueSet ID: </span>
                                <select class="form-control form-control-short" ng-class="{'form-control-invalid': isEmptyConstraintValueSet(newConstraint)}" ng-model="newConstraint.valueSetId">
                                    <option ng-repeat="table in tables track by table.id|orderBy:'+bindingIdentifier'" value="{{table.bindingIdentifier}}">
                                        {{::table.bindingIdentifier}}
                                    </option>
                                </select>
                                <span style="color:red;" ng-show="isEmptyConstraintValueSet(newConstraint)">Empty valueset</span>
                                <br/>
                                <span>BindingStrength: </span>
                                <select name="bindingStrength" class="form-control form-control-short" ng-model="newConstraint.bindingStrength">
                                    <option value="R">R</option>
                                    <option value="S">S</option>
                                    <option value="U">U</option>
                                </select>
                                <br/>
                                <span>BindingLocation: </span>
                                <input class="form-control form-control-short" ng-model="newConstraint.bindingLocation" type="text" />
                            </span>
                        </td>
                        <td class="col-md-2" data-drop="true"  data-jqyoui-options ng-model="secondNodeData" jqyoui-droppable="{beforeDrop: 'beforeNodeDrop', onDrop: 'afterSecondNodeDrop'}"
                            ng-show="newConstraint.contraintType == 'identical to another node' ||
                                     newConstraint.contraintType == 'equal to another node' ||
                                     newConstraint.contraintType == 'not-equal to another node' ||
                                     newConstraint.contraintType == 'greater than another node' ||
                                     newConstraint.contraintType == 'equal to or greater than another node' ||
                                     newConstraint.contraintType == 'less than another node' ||
                                     newConstraint.contraintType == 'equal to or less than another node'">
                            <div ng-show="draggingStatus == 'ContextTreeNodeDragging'">
                                <span style="color:red;" class="blink_me">You can drop Here!!</span>
                            </div>
                            <div ng-show="newConstraint.location_2">
                                <span>
                                    <span ng-repeat="info in newConstraint.pathInfoSet_2">
                                        <span ng-show="$index == 1 && info.isInstanceNumberEditable">
                                            {{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateSecondPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index == 1 && !info.isInstanceNumberEditable">
                                            {{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index > 1 && info.isInstanceNumberEditable">
                                            .{{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateSecondPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index > 1 && !info.isInstanceNumberEditable">
                                            .{{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index == newConstraint.pathInfoSet_1.length - 1">
                                            ({{info.nodeName}})
                                        </span>
                                    </span>
                                </span>
                            </div>
                            <div ng-show="!newConstraint.location_2">
                                <span style="color:red;">Drop the node!</span>
                            </div>
                        </td>
                        <td class="col-md-2" align="center">
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="initPredicate()"><span><i class="fa fa-refresh fa-fw">&nbsp; </i>Reset</span></button>
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="addPredicate();" ng-disabled="erorrForPredicate(newConstraint, 'message', selectedNode)"><span><i class="fa fa-plus fa-fw">&nbsp; </i>Add</span></button>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <table class="table table-striped table-bordered" ng-show="constraintType === 'Complex'">
                    <thead>
                    <tr class="tbl-header">
                        <th class="col-md-2">Complex Type</th>
                        <th class="col-md-1"></th>
                        <th ng-show="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-7">Constraints</th>
                        <th ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-3">First Constraint</th>
                        <th ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-1"></th>
                        <th ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-3">Second Constraint</th>
                        <th class="col-md-2"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-2">
                            <select class="form-control" ng-class="{'form-control-invalid': isEmptyCompositeType(compositeType)}" ng-model="compositeType">
                                <option value="AND">AND</option>
                                <option value="OR">OR</option>
                                <option value="XOR">XOR</option>
                                <option value="IFTHEN">IFTHEN(IMPLY)</option>
                                <option value="FORALL">FORALL(True, if all assertions are true)</option>
                                <option value="EXIST">EXIST(True, if one of assertions is true)</option>
                            </select>
                            <span style="color:red;" ng-show="isEmptyCompositeType(compositeType)">Empty composite type</span>
                        </td>
                        <td class="col-md-1" align="center">
                            <span ng-show="compositeType == 'IFTHEN'">IF</span>
                            <span ng-show="compositeType == 'FORALL'">FORALL</span>
                            <span ng-show="compositeType == 'EXIST'">EXIST</span>
                        </td>
                        <td ng-show="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-7" data-drop="true" ng-model='constraints' jqyoui-droppable="{multiple:true}" data-jqyoui-options>
                            <span style="color:red;" ng-show="constraints.length < 2">Drop two more constraints here!</span>
                            <li ng-repeat="c in constraints" ng-show="constraints.length > 0" data-drag="true" data-jqyoui-options="{revert: 'invalid', helper: 'clone'}" ng-model="constraints" jqyoui-draggable="{animate:true}">{{c.description}}</li>
                        </td>
                        <td ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-3" data-drop="true" data-jqyoui-options ng-model="firstConstraint" jqyoui-droppable>
                            <span style="color:red;" ng-hide="firstConstraint">Drop the first constraint here!</span>
                            <span data-drag="false" data-jqyoui-options ng-model="firstConstraint" jqyoui-draggable ng-hide="!firstConstraint">{{firstConstraint.description}}</span>
                        </td>
                        <td ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-1" align="center">
                            <span ng-show="compositeType == 'AND'">AND</span>
                            <span ng-show="compositeType == 'OR'">OR</span>
                            <span ng-show="compositeType == 'XOR'">XOR</span>
                            <span ng-show="compositeType == 'IFTHEN'">THEN</span>
                        </td>
                        <td ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-3"data-drop="true"  data-jqyoui-options ng-model="secondConstraint" jqyoui-droppable>
                            <span style="color:red;" ng-hide="secondConstraint">Drop the second constraint here!</span>
                            <span data-drag="false" data-jqyoui-options ng-model="secondConstraint" jqyoui-draggable ng-hide="!secondConstraint">{{secondConstraint.description}}</span>
                        </td>
                        <td class="col-md-1" align="center">
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="initComplexPredicate()"><span><i class="fa fa-refresh fa-fw">&nbsp; </i>Reset</span></button>
                            <button class="btn btn-raised btn-primary btn-xxs" ng-click="addComplexPredicate()" ng-disabled="erorrForComplexPredicate(compositeType, firstConstraint, secondConstraint, null, null, constraints)">
                                <span><i class="fa fa-plus fa-fw">&nbsp; </i>Add</span>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-raised btn-warning btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span></button>
        <button type="button" class="btn btn-raised btn-success btn-sm" ng-disabled="!changed" ng-click="saveclose()"><span><i class="fa fa-check fa-fw">&nbsp; </i>Save</span></button>
    </div>
</script>

<script type="text/ng-template" id="GlobalConformanceStatementCtrl.html">
    <div class="modal-header">
        <h3 class="header4">Global Conformance Statements</h3>
    </div>

    <div class="modal-body">
        <form role="form">
            <div class="col-md-6">
                <div class="panel panel-default">
                    <div class="panel-heading">Full Message</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <table class="table table-striped">
                            <tbody ng-repeat="data in treeDataForMessage" ng-include="'message_tree_item.html'">
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="panel panel-default" data-drop="true"  data-jqyoui-options ng-model="treeDataForContext" jqyoui-droppable="{beforeDrop: 'beforeContextDrop', onDrop: 'afterContextDrop'}">
                    <div class="panel-heading">Selected Context</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <div ng-show="draggingStatus == 'MessageTreeNodeDragging'">
                            <span style="color:red;" class="blink_me">You can drop here!!</span>
                        </div>
                        <div ng-show="treeDataForContext.length > 0">
                            <table class="table table-striped">
                                <tbody ng-repeat="data in treeDataForContext" ng-include="'context_tree_item.html'">
                                </tbody>
                            </table>
                        </div>
                        <div ng-show="treeDataForContext.length == 0">
                            <span style="color:red;">No Selected Context</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12" style="margin-top: 10px">
                <div class="panel panel-default">
                    <div class="panel-heading">Conformance Statements</div>
                    <div class="panel-body" style="min-height:200px; max-height:200px;overflow-y: scroll;">
                        <table st-table="displayed" st-safe-src="targetContext.conformanceStatements" class="table table-striped table-bordered">
                            <thead>
                            <tr class="tbl-header">
                                <th ng-show="constraintType === 'Complex'" class="col-md-1" style="width: 4.1667%">Draggable</th>
                                <th st-sort="constraintId" class="col-md-2">ID</th>
                                <th class="col-md-8">Description (
                                    <input type="checkbox" ng-model="viewAssertion"> view assertion )
                                </th>
                                <th class="col-md-1"></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="c in displayed">
                                <td ng-show="constraintType === 'Complex'" class="col-md-1" align="center" style="width: 4.1667%">
                                    <i ng-show="c.assertion" class="glyphicon glyphicon-move cursorMove" data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="c" jqyoui-draggable="{placeholder:'keep',animate:true}"></i>
                                </td>
                                <td class="col-md-2">
                                    <input class="form-control" ng-model="c.constraintId" ng-change="setChanged();" type="text" />
                                    <span style="color:red;" ng-show="isEmptyConstraintID(c)">ID Empty</span>
                                </td>
                                <td class="col-md-8">
                                    <input class="form-control" ng-model="c.description" ng-change="setChanged()" type="text" />
                                    <input ng-show="viewAssertion" class="form-control" ng-model="c.assertion" ng-change="setChanged()" type="text"/>
                                </td>
                                <td class="col-md-1" align="center">
                                    <button class="btn btn-raised btn-danger btn-xxs" ng-click="deleteConformanceStatement(c)"><span><i class="fa fa-trash fa-fw">&nbsp; </i>Del</span></button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <span class="pull-right">
                    <div class="btn-group btn-group-sm" data-toggle="buttons">
                        <label class="btn btn-raised btn-primary btn-xs" ng-click="constraintType = 'Free'; newConstraint.constraintId = calNextCSID(igdocument.metaData.ext, selectedMessage.structID);" ng-class="{'active':constraintType === 'Free'}">
                            <input type="radio" ng-value="constraintType">Add new Free-Text Conf.Statement
                        </label>
                        <label class="btn btn-raised btn-primary btn-xs" ng-click="constraintType = 'Plain'; newConstraint.constraintId = calNextCSID(igdocument.metaData.ext, selectedMessage.structID);" ng-class="{'active':constraintType === 'Plain'}">
                            <input type="radio" ng-value="constraintType">Add New Plain Conf.Statement
                        </label>
                        <label class="btn btn-raised btn-primary btn-xs" ng-click="constraintType = 'Complex'; newComplexConstraintId = calNextCSID(igdocument.metaData.ext, selectedMessage.structID);" ng-class="{'active':constraintType === 'Complex'}">
                            <input type="radio" ng-value="constraintType">Add New Complex Conf.Statement
                        </label>
                    </div>
                </span>

                <table class="table table-striped table-bordered" ng-show="constraintType === 'Free'">
                    <thead>
                    <tr class="tbl-header">
                        <th class="col-md-2">ID</th>
                        <th class="col-md-8">Free-Text (Not supported by validation tool)</th>
                        <th class="col-md-2"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-2">
                            <input class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintID(newConstraint)}" ng-model="newConstraint.constraintId" type="text"/>
                            <span style="color:red;" ng-show="isEmptyConstraintID(newConstraint)">ID Empty</span>
                        </td>
                        <td class="col-md-8">
                            <input class="form-control" ng-model="newConstraint.freeText" type="text" />
                        </td>
                        <td class="col-md-2" align="center">
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="initConformanceStatement()"><span><i class="fa fa-refresh fa-fw">&nbsp; </i>Reset</span></button>
                            <button class="btn btn-raised btn-primary btn-xxs" ng-click="addFreeTextConformanceStatement();"><span><i class="fa fa-plus fa-fw">&nbsp; </i>Add</span></button>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <table class="table table-striped table-bordered" ng-show="constraintType === 'Plain'">
                    <thead>
                    <tr class="tbl-header">
                        <th class="col-md-2">ID</th>
                        <th class="col-md-2">Node</th>
                        <th class="col-md-2">Verb</th>
                        <th class="col-md-2">Constraint Pattern</th>
                        <th class="col-md-2">Value</th>
                        <th class="col-md-2"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-2">
                            <input class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintID(newConstraint)}" ng-model="newConstraint.constraintId" type="text"/>
                            <span style="color:red;" ng-show="isEmptyConstraintID(newConstraint)">ID Empty</span>
                        </td>
                        <td class="col-md-2" data-drop="true"  data-jqyoui-options ng-model="firstNodeData" jqyoui-droppable="{beforeDrop: 'beforeNodeDrop', onDrop: 'afterNodeDrop'}">
                            <div ng-show="draggingStatus == 'ContextTreeNodeDragging'">
                                <span style="color:red;" class="blink_me">You can drop here!!</span>
                            </div>
                            <div ng-show="newConstraint.location_1">
                                <span>
                                    <span ng-repeat="info in newConstraint.pathInfoSet_1">
                                        <span ng-show="$index == 1 && info.isInstanceNumberEditable">
                                            {{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateFirstPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index == 1 && !info.isInstanceNumberEditable">
                                            {{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index > 1 && info.isInstanceNumberEditable">
                                            .{{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateFirstPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index > 1 && !info.isInstanceNumberEditable">
                                            .{{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index == newConstraint.pathInfoSet_1.length - 1">
                                            ({{info.nodeName}})
                                        </span>
                                    </span>
                                </span>
                            </div>
                            <div ng-show="!newConstraint.location_1">
                                <span style="color:red;">Drop the node!</span>
                            </div>
                        </td>
                        <td class="col-md-2">
                            <select class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintVerb(newConstraint)}" ng-model="newConstraint.verb" ng-options="constraintVerb for constraintVerb in config.constraintVerbs | orderBy:'toString()'" />
                            <span style="color:red;" ng-show="isEmptyConstraintVerb(newConstraint)">Empty verb</span>
                        </td>
                        <td class="col-md-2">
                            <select class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintPattern(newConstraint)}" ng-model="newConstraint.contraintType" ng-options="contraintType for contraintType in config.constraintTypes | orderBy:'toString()'" />
                            <span style="color:red;" ng-show="isEmptyConstraintPattern(newConstraint)">Empty constraint pattern</span>
                        </td>
                        <td class="col-md-2"
                            ng-hide="newConstraint.contraintType == 'identical to another node' ||
                                     newConstraint.contraintType == 'equal to another node' ||
                                     newConstraint.contraintType == 'not-equal to another node' ||
                                     newConstraint.contraintType == 'greater than another node' ||
                                     newConstraint.contraintType == 'equal to or greater than another node' ||
                                     newConstraint.contraintType == 'less than another node' ||
                                     newConstraint.contraintType == 'equal to or less than another node'">
                            <span ng-show="newConstraint.contraintType == 'a literal value' ||
                                           newConstraint.contraintType == 'equal to' ||
                                           newConstraint.contraintType == 'not-equal to' ||
                                           newConstraint.contraintType == 'greater than' ||
                                           newConstraint.contraintType == 'equal to or greater than' ||
                                           newConstraint.contraintType == 'less than' ||
                                           newConstraint.contraintType == 'equal to or less than'">
                                <input class="form-control" ng-class="{'form-control-invalid': isEmptyConstraintValue(newConstraint)}" ng-model="newConstraint.value" type="text"/>
                                <span ng-show="newConstraint.contraintType == 'a literal value'">Case Insensitive: </span>
                                <input ng-show="newConstraint.contraintType == 'a literal value'" type="checkbox" ng-model="newConstraint.ignoreCase" />
                                <span style="color:red;" ng-show="isEmptyConstraintValue(newConstraint)">Empty value</span>
                            </span>
                            <span ng-show="newConstraint.contraintType == 'one of list values'">
                                <input class="form-control"
                                       ng-class="{'form-control-invalid': isEmptyConstraintValue(newConstraint)}"
                                       ng-model="newConstraint.value"
                                       placeholder="Comma-Separated Values(CSV)"
                                       type="text"/>
                                <span style="color:red;" ng-show="isEmptyConstraintValue(newConstraint)">Empty list value</span>
                            </span>
                            <span ng-show="newConstraint.contraintType == 'formatted value'">
                                <select class="form-control"
                                        ng-class="{'form-control-invalid': isEmptyConstraintValue(newConstraint)}"
                                        ng-model="newConstraint.value"
                                        ng-options="predefinedFormat for predefinedFormat in config.predefinedFormats | orderBy:'toString()'"/>
                                <div ng-show="newConstraint.value === 'Regular expression'">
                                    <input class="form-control"
                                           ng-class="{'form-control-invalid': isEmptyConstraintValue2(newConstraint)}"
                                           ng-model="newConstraint.value2" placeholder="Regular expression" type="text"/>
                                </div>
                                <span style="color:red;" ng-show="isEmptyConstraintValue(newConstraint)">Empty format</span>
                                <span style="color:red;" ng-show="newConstraint.value === 'Regular expression' && isEmptyConstraintValue2(newConstraint)">Empty regular expression</span>
                            </span>
                            <span ng-show="newConstraint.contraintType == 'one of codes in ValueSet'">
                                <span>ValueSet ID: </span>
                                <select class="form-control form-control-short" ng-class="{'form-control-invalid': isEmptyConstraintValueSet(newConstraint)}" ng-model="newConstraint.valueSetId">
                                    <option ng-repeat="table in tables track by table.id|orderBy:'+bindingIdentifier'" value="{{table.bindingIdentifier}}">
                                        {{::table.bindingIdentifier}}
                                    </option>
                                </select>
                                <span style="color:red;" ng-show="isEmptyConstraintValueSet(newConstraint)">Empty valueset</span>
                                <br/>
                                <span>BindingStrength: </span>
                                <select name="bindingStrength" class="form-control form-control-short" ng-model="newConstraint.bindingStrength">
                                    <option value="R">R</option>
                                    <option value="S">S</option>
                                    <option value="U">U</option>
                                </select>
                                <br/>
                                <span>BindingLocation: </span>
                                <input class="form-control form-control-short" ng-model="newConstraint.bindingLocation" type="text" />
                            </span>
                        </td>
                        <td class="col-md-2" data-drop="true"  data-jqyoui-options ng-model="secondNodeData" jqyoui-droppable="{beforeDrop: 'beforeNodeDrop', onDrop: 'afterSecondNodeDrop'}"
                            ng-show="newConstraint.contraintType == 'identical to another node' ||
                                     newConstraint.contraintType == 'equal to another node' ||
                                     newConstraint.contraintType == 'not-equal to another node' ||
                                     newConstraint.contraintType == 'greater than another node' ||
                                     newConstraint.contraintType == 'equal to or greater than another node' ||
                                     newConstraint.contraintType == 'less than another node' ||
                                     newConstraint.contraintType == 'equal to or less than another node'">
                            <div ng-show="draggingStatus == 'ContextTreeNodeDragging'">
                                <span style="color:red;" class="blink_me">You can drop Here!!</span>
                            </div>
                            <div ng-show="newConstraint.location_2">
                                <span>
                                    <span ng-repeat="info in newConstraint.pathInfoSet_2">
                                        <span ng-show="$index == 1 && info.isInstanceNumberEditable">
                                            {{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateSecondPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index == 1 && !info.isInstanceNumberEditable">
                                            {{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index > 1 && info.isInstanceNumberEditable">
                                            .{{info.locationName}}[<input class="form-control-veryshort" ng-model="info.instanceNumber" ng-change="generateSecondPositionAndLocationPath();" type="text"/>]
                                        </span>
                                        <span ng-show="$index > 1 && !info.isInstanceNumberEditable">
                                            .{{info.locationName}}[{{info.instanceNumber}}]
                                        </span>
                                        <span ng-show="$index == newConstraint.pathInfoSet_1.length - 1">
                                            ({{info.nodeName}})
                                        </span>
                                    </span>
                                </span>
                            </div>
                            <div ng-show="!newConstraint.location_2">
                                <span style="color:red;">Drop the node!</span>
                            </div>
                        </td>
                        <td class="col-md-2" align="center">
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="addConformanceStatement();" ng-disabled="erorrForConfStatement(newConstraint, targetPlainId, 'message', selectedNode)"><span><i class="fa fa-plus fa-fw">&nbsp; </i>Add</span></button>
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="initConformanceStatement()"><span><i class="fa fa-refresh fa-fw">&nbsp; </i>Reset</span></button>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <table class="table table-striped table-bordered" ng-show="constraintType === 'Complex'">
                    <thead>
                    <tr class="tbl-header">
                        <th class="col-md-2">ID</th>
                        <th class="col-md-2">Complex Type</th>
                        <th class="col-md-1" style="width: 4.1667%"></th>
                        <th ng-show="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-5">Constraints</th>
                        <th ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-2">First Constraint</th>
                        <th ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-1" style="width: 4.1667%"></th>
                        <th ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-2">Second Constraint</th>
                        <th class="col-md-2"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-2">
                            <input class="form-control" ng-class="{'form-control-invalid': !newComplexConstraintId || newComplexConstraintId == ''}" ng-model="newComplexConstraintId" type="text"/>
                            <span style="color:red;" ng-show="!newComplexConstraintId || newComplexConstraintId == ''">ID Empty</span>
                        </td>
                        <td class="col-md-2">
                            <select class="form-control" ng-class="{'form-control-invalid': isEmptyCompositeType(compositeType)}" ng-model="compositeType">
                                <option value="AND">AND</option>
                                <option value="OR">OR</option>
                                <option value="XOR">XOR</option>
                                <option value="IFTHEN">IFTHEN(IMPLY)</option>
                                <option value="FORALL">FORALL(True, if all assertions are true)</option>
                                <option value="EXIST">EXIST(True, if one of assertions is true)</option>
                            </select>
                            <span style="color:red;" ng-show="isEmptyCompositeType(compositeType)">Empty composite type</span>
                        </td>
                        <td class="col-md-1" align="center" style="width: 4.1667%">
                            <span ng-show="compositeType == 'IFTHEN'">IF</span>
                            <span ng-show="compositeType == 'FORALL'">FORALL</span>
                            <span ng-show="compositeType == 'EXIST'">EXIST</span>
                        </td>
                        <td ng-show="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-5" data-drop="true" ng-model='constraints' jqyoui-droppable="{multiple:true}" data-jqyoui-options>
                            <span style="color:red;" ng-show="constraints.length < 2">Drop two more constraints here!</span>
                            <li ng-repeat="c in constraints" ng-show="constraints.length > 0" data-drag="true" data-jqyoui-options="{revert: 'invalid', helper: 'clone'}" ng-model="constraints" jqyoui-draggable="{animate:true}">{{c.description}}</li>
                        </td>
                        <td ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-2" data-drop="true" data-jqyoui-options ng-model="firstConstraint" jqyoui-droppable>
                            <span style="color:red;" ng-hide="firstConstraint">Drop the first constraint here!</span>
                            <span data-drag="false" data-jqyoui-options ng-model="firstConstraint" jqyoui-draggable ng-hide="!firstConstraint">{{firstConstraint.description}}</span>
                        </td>
                        <td ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-1" align="center" style="width: 4.1667%">
                            <span ng-show="compositeType == 'AND'">AND</span>
                            <span ng-show="compositeType == 'OR'">OR</span>
                            <span ng-show="compositeType == 'XOR'">XOR</span>
                            <span ng-show="compositeType == 'IFTHEN'">THEN</span>
                        </td>
                        <td ng-hide="compositeType == 'FORALL' || compositeType == 'EXIST'" class="col-md-2"data-drop="true"  data-jqyoui-options ng-model="secondConstraint" jqyoui-droppable>
                            <span style="color:red;" ng-hide="secondConstraint">Drop the second constraint here!</span>
                            <span data-drag="false" data-jqyoui-options ng-model="secondConstraint" jqyoui-draggable ng-hide="!secondConstraint">{{secondConstraint.description}}</span>
                        </td>
                        <td class="col-md-1" align="center">
                            <button class="btn btn-raised btn-info btn-xxs" ng-click="initComplexStatement()"><span><i class="fa fa-refresh fa-fw">&nbsp; </i>Reset</span></button>
                            <button class="btn btn-raised btn-primary btn-xxs" ng-click="addComplexConformanceStatement()" ng-disabled="erorrForComplexConfStatement(newComplexConstraintId, targetComplexId, compositeType, firstConstraint, secondConstraint, constraints)">
                                <span><i class="fa fa-plus fa-fw">&nbsp; </i>Add</span>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-raised btn-warning btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
        &nbsp; </i>Cancel</span></button>
        <button type="button" class="btn btn-raised btn-success btn-sm" ng-disabled="!changed" ng-click="saveclose()"><span><i class="fa fa-check fa-fw">
            &nbsp; </i>Save</span></button>
    </div>
</script>

<script type="text/ng-template" id="context_tree_item.html">
    <tr style="width:100%">
        <td ng-if="data.folderClass">
            <div ng-if="data.type === 'message' || data.type === 'group' || data.type === 'segmentRef'">
                <i class="fa" ng-class="data.folderClass" ng-click="toggleChildren(data)"></i>
            </div>
            <div ng-if="data.type === 'field' || data.type === 'component'">
                <div ng-if="data.child.components &&  data.child.components.length > 0">
                    <i class="fa" ng-class="data.folderClass" ng-click="toggleChildren(data)"></i>
                </div>
                <div ng-if="!data.child.components ||  data.child.components.length == 0">
                    <i class="fa fa-check"/>
                </div>
            </div>
        </td>
        <td ng-if="!data.folderClass">
            <div ng-if="data.type === 'message' || data.type === 'group' || data.type === 'segmentRef'">
                <i class="fa fa-plus" ng-click="toggleChildren(data)"></i>
            </div>
            <div ng-if="data.type === 'field' || data.type === 'component'">
                <div ng-if="data.child.components &&  data.child.components.length > 0">
                    <i class="fa fa-plus" ng-click="toggleChildren(data)"></i>
                </div>
                <div ng-if="!data.child.components ||  data.child.components.length == 0">
                    <i class="fa fa-check"/>
                </div>
            </div>
        </td>
        <td>
            <div ng-if="data.type === 'message'">
                <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromContextTree({nodeData: data})'}">
                    <span class="label label-success label-icon">M</span>
                    <span>&nbsp;{{::data.name}}</span>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.children" ng-include="'context_tree_item.html'"></div>
                    </table>
                </div>
            </div>
            <div ng-if="data.type === 'group'">
                <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromContextTree({nodeData: data})'}">
                    <span class="label label-success label-icon">G</span>
                    <span>&nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::data.name}}</span>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.children" ng-include="'context_tree_item.html'"></div>
                    </table>
                </div>
            </div>
            <div ng-if="data.type === 'segmentRef'">
                <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromContextTree({nodeData: data})'}">
                    <span class="label label-segment label-icon">S</span>
                    <span>&nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::segmentsMap[data.ref.id].name}}</span>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.segment.fields" ng-include="'context_tree_item.html'"></div>
                    </table>
                </div>
            </div>
            <div ng-if="data.type === 'field'">
                <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromContextTree({nodeData: data})'}">
                    <span class="label label-field label-icon">F</span>
                    <span>&nbsp;{{::data.position}}. &nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}] {{::data.name}}</span>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.child.components" ng-include="'context_tree_item.html'"></div>
                    </table>
                </div>
            </div>
            <div ng-if="data.type === 'component'">
                <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromContextTree({nodeData: data})'}">
                    <span class="label label-component label-icon">C</span>
                    <span>&nbsp;{{::data.position}}. &nbsp;[{{::data.usage}}] {{::data.name}}</span>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.child.components" ng-include="'context_tree_item.html'"></div>
                    </table>
                </div>
            </div>
        </td>
    </tr>
</script>

<script type="text/ng-template"  id="message_tree_item.html">
    <tr style="width:100%">
        <td ng-if="data.type !== 'segmentRef' && data.folderClass">
            <i class="fa" ng-class="data.folderClass" ng-click="toggleChildren(data)"></i>
        </td>
        <td ng-if="data.type !== 'segmentRef' && !data.folderClass">
            <i class="fa fa-plus" ng-click="toggleChildren(data)"></i>
        </td>
        <td ng-if="data.type === 'segmentRef'">
            <i class="fa fa-check"/>
        </td>
        <td>
            <div ng-if="data.type !== 'segmentRef'" >
                <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromMessageTree({nodeData: data})'}">
                    <span ng-show="data.type === 'group'" class="label label-success label-icon">G</span>
                    <span ng-show="data.type === 'group'">&nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::data.name}}</span>
                    <span ng-show="data.type === 'message'" class="label label-success label-icon">M</span>
                    <span ng-show="data.type === 'message'">&nbsp;{{::data.name}}</span>
                    <i class="glyphicon glyphicon-move cursorMove"></i>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.children" ng-include="'message_tree_item.html'"></div>
                    </table>
                </div>
            </div>
            <div ng-if="data.type === 'segmentRef'" ><span class="label label-segment label-icon">S</span>
                &nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::segmentsMap[data.ref.id].name}}
            </div>
        </td>
    </tr>
</script>

<script type="text/ng-template"  id="message_tree_Predicate_item.html">
    <tr style="width:100%">
        <td ng-if="data.type !== 'segmentRef' && data.folderClass">
            <i class="fa" ng-class="data.folderClass" ng-click="toggleChildren(data)"></i>
        </td>
        <td ng-if="data.type !== 'segmentRef' && !data.folderClass">
            <i class="fa fa-plus" ng-click="toggleChildren(data)"></i>
        </td>
        <td ng-if="data.type === 'segmentRef'">
            <i class="fa fa-check"/>
        </td>
        <td>
            <div ng-if="data.type !== 'segmentRef'" >
                <div ng-if="data.type == 'message' || selectedNode.path.startsWith(data.positionPath)" >
                    <div data-drag="true" data-jqyoui-options="{revert: 'invalid',helper:'clone'}" ng-model="data" jqyoui-draggable="{placeholder:'keep',animate:true, onStart:'draggingNodeFromMessageTree({nodeData: data})'}">
                        <span ng-show="data.type === 'group'" class="label label-success label-icon">G</span>
                        <span ng-show="data.type === 'group'">&nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::data.name}}</span>
                        <span ng-show="data.type === 'message'" class="label label-success label-icon">M</span>
                        <span ng-show="data.type === 'message'">&nbsp;{{::data.name}}</span>
                        <i class="glyphicon glyphicon-move cursorMove"></i>
                    </div>
                </div>
                <div ng-if="data.type != 'message' && !selectedNode.path.startsWith(data.positionPath)" >
                    <span ng-show="data.type === 'group'" class="label label-success label-icon">G</span>
                    <span ng-show="data.type === 'group'">&nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::data.name}}</span>
                    <span ng-show="data.type === 'message'" class="label label-success label-icon">M</span>
                    <span ng-show="data.type === 'message'">&nbsp;{{::data.name}}</span>
                </div>
                <div id="expanded-data" ng-if="data.childrenVisible">
                    <table class="table table-striped" id="nested-table">
                        <div ng-repeat="data in data.children" ng-include="'message_tree_Predicate_item.html'"></div>
                    </table>
                </div>
            </div>
            <div ng-if="data.type === 'segmentRef'" ><span class="label label-segment label-icon">S</span>
                &nbsp;[{{::data.min}}..{{::data.max}},{{::data.usage}}]&nbsp;{{::segmentsMap[data.ref.id].name}}
            </div>
        </td>
    </tr>
</script>

<script type="text/ng-template" id="MessageReadTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)">
        <td class="col-md-2 col-fixed-250">
            <span>{{::node.obj.event}}^{{::node.obj.structID}}:{{::node.obj.description}}</span>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-2 emptyCol" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
         </td>
        <td class="col-md-3 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
         </td>
    </tr>
</script>
<script type="text/ng-template" id="MessageSegmentRefReadTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)" ng-show="(isVisible(node.obj) &&( node.obj.usage==='R' ||node.obj.usage==='RE' ||node.obj.usage==='C' )&& $root.usageF) || (isVisible(node.obj) && !$root.usageF)">
        <td class="col-md-2 col-fixed-250">
            <span class="label label-segment label-icon">S</span>
            <!--<a-->
            <!--tooltip-html="getGroupNodeName(node.obj)" tooltip-append-to-body="true"-->
            <!--class="point"-->
            <!--ng-click="goToSegment(node.obj.ref)"-->
            <!--tooltip-class="constraints-tooltip" ng-bind-html="getSegmentRefNodeName(node.obj)" tooltip-trigger-->
            <!--tooltip-animation="false" tooltip-placement="left"-->
            <span>
                {{getSegmentLabel(segmentsMap[node.obj.ref.id])}}
            </span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <span ng-bind="node.obj.usage"></span>
            <span ng-repeat="p in filteredConstraints  = (message.predicates | filter:{constraintTarget:node.path}:true)">
                    ({{::p.trueUsage}}/{{::p.falseUsage}})
            </span>
        </td>
        <td class="col-md-1 col-fixed-100">
            [{{::node.obj.min}}, {{::node.obj.max}}]
        </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-2" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <p ng-repeat="constraint in filteredConstraints  = (message.predicates | filter:{constraintTarget:node.path}:true)" tooltip-html="getPredicateAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(constraint)"
                    tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-3 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <!--<div>-->
                <!--<p ng-repeat="constraint in filteredConstraints  = (message.conformanceStatements | filter:{constraintTarget:node.path}:true)" tooltip-html="getConformanceStatementAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip"-->
                    <!--ng-bind-html="getConstraintAsId(constraint)" tooltip-trigger tooltip-animation="false" tooltip-placement="left">-->
                <!--</p>-->
            <!--</div>-->
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <!--<p class="form-control" style="width:100%;height:100%" ng-bind="node.obj.comment" ng-show="node.obj.comment != null && node.obj.comment != ''">-->
            <!--</p>-->
            <a ng-click="openInputTextDlg(node.obj, 'comment','Comment', true)" class="point" ng-show="node.obj.comment !== '' && node.obj.comment !== null" tooltip-html="node.obj.comment" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" tooltip-trigger
                tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ></i>
            </a>
        </td>
    </tr>
</script>
<script type="text/ng-template" id="MessageGroupReadTree.html">
    <tr tt-node is-branch="hasChildren(node.obj)" ng-show="(isVisible(node.obj) &&( node.obj.usage==='R' ||node.obj.usage==='RE' ||node.obj.usage==='C' )&& $root.usageF) || (isVisible(node.obj) && !$root.usageF)">
        <td class="col-md-2 col-fixed-250">
            <span>

                                           <span class="label label-success label-icon">G</span>
            <span ng-bind="::getGroupNodeName(node.obj)"></span>
            </span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <div>
                <span ng-bind="node.obj.usage"></span>
                <span ng-repeat="p in filteredConstraints  = (message.predicates | filter:{constraintTarget:node.path}:true) ">
                    ({{::p.trueUsage}}/{{::p.falseUsage}})
                </span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100">
            [{{::node.obj.min}}, {{::node.obj.max}}]
        </td>
        <td class="col-md-1 col-fixed-100">
            <div>-</div>
        </td>
        <td class="col-md-1 col-fixed-80">
            <div>-</div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            <div>-</div>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">
            <div>-</div>
        </td>
        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <p ng-repeat="constraint in filteredConstraints  = (message.predicates | filter:{constraintTarget:node.path}:true) " tooltip-html="getPredicateAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(constraint)"
                    tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <!--<div>-->
                <!--<p ng-repeat="constraint in filteredConstraints  = (message.conformanceStatements | filter:{constraintTarget:node.path}:true) " tooltip-html="getConformanceStatementAsString(constraint)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip"-->
                    <!--ng-bind-html="getConstraintAsId(constraint)" tooltip-trigger tooltip-animation="false" tooltip-placement="left">-->
                <!--</p>-->
            <!--</div>-->
        </td>
        <td class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">
            <div>-</div>
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <!--<p class="form-control" style="width:100%;height:100%" ng-bindl="node.obj.comment" ng-show="node.obj.comment !== '' && node.obj.comment !== null">-->
            <!--</p>-->
            <a ng-click="openInputTextDlg(node.obj, 'comment','Comment', true)" class="point" ng-show="node.obj.comment !== '' && node.obj.comment !== null" tooltip-html="node.obj.comment" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" tooltip-trigger
                tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ng-show="node.obj.comment !== '' && node.obj.comment !== null"></i>
            </a>
        </td>
    </tr>
</script>
<script type="text/ng-template" id="AddSegmentModal.html">
    <div class="modal-header modal-wide">
        <div class="form-inline">
            <span class="header4">Create Segment</span>
        </div>
    </div>
    <div class="modal-body">
        <div class="creation-modal-content">
            <form name="addSegForm" class="form-horizontal" novalidate>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !selected()}">
                    <label class="col-md-3 control-label">Existing Segment*</label>
                    <div class="controls col-md-9">
                        <input class="input-group form-control" type="text" ng-model="search.name" ng-hide="selected()" required/>
                        <li class="form-control" ng-show="selected()">
                            {{newSeg.name}} <span ng-show="newSeg.ext">_{{newSeg.ext}}</span>
                            <button type="button" class="close" aria-label="Close" ng-click="unselect()">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </li>
                        <div ng-show="search.name && !selected()">
                            <li class="form-control" ng-class="{'active':isActive(segment.id)}" ng-click="selectSeg(segment)" ng-repeat="segment in segments | filter:search">
                                {{segment.name}} <span ng-show="segment.ext">_{{segment.ext}}</span>
                            </li>
                        </div>
                    </div>
                </div>

                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addSegForm.inputPosition.$valid}">
                    <label class="col-md-3 control-label">Position*</label>
                    <div class="controls col-md-9">
                        <select ng-model="position" ng-change="selectPos()" class="form-control input-sm" required id="inputPosition" name="inputPosition">
                            <option ng-show="segmentParent.type==='message'" ng-repeat="child in segmentParent.children"> {{child.position}}
                                <option ng-show="segmentParent.obj && segmentParent.obj.type==='group'" ng-repeat="child in segmentParent.children"> {{child.obj.position}}
                                    <option value="{{segmentParent.children.length+1}}">{{segmentParent.children.length+1}}
                        </select>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addSegForm.usage.$valid}">
                    <label class="col-md-3 control-label">Usage*</label>
                    <div class="controls col-md-9">
                        <select class="form-control input-sm" name="usage" id="usage" ng-change="selectUsage(newSegment.usage)" required ng-model="newSegment.usage" ng-options="usage for usage in config.usages" required />
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addSegForm.min.$valid ||!addSegForm.max.$valid }">
                    <label class="col-md-3 control-label">Cardinality*</label>
                    <div class="controls col-md-9">
                        <span class="form-inline">
                                                <input  style="width:49%;margin-right: 1px" class="form-control"
                                                    placeholder="Min"
                                                        

                                                       name="min"
                                                       id="min"
                                                       ng-change="setDirty()"
                                                       ng-pattern="/^\d+$/"
                                                       ng-model="newSegment.min" required  ng-disabled="disableMin">
                                                <input  style="width:50%" class="form-control"type="text"
                                                    placeholder="Max"



                                                       name="max"
                                                       id="max"
                                                       ng-change="setDirty()"
                                                       
                                                       ng-pattern="/^\d+$|^\*?$/"
                                                       ng-model="newSegment.max" ng-disabled="disableMax" required>
                                            </span>
                    </div>
                </div>
                <div class="form-group control-group">
                    <label class="col-md-3 control-label">Comment</label>
                    <div class="controls col-md-9">
                        <textarea class="form-control" ng-model="newSegment.comment">
                    </textarea>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-raised btn-default btn-md" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
                &nbsp; </i>Cancel</span>
            </button>
            <button class="btn btn-raised btn-info btn-md" type="submit" ng-click="addSegment()" ng-disabled="addSegForm.$invalid || !selected()"><span><i
                    class="fa fa-plus fa-fw">
                &nbsp; </i>Add</span>
            </button>
        </div>
    </div>
</script>
<script type="text/ng-template" id="AddGroupModal.html">
    <div class="modal-header modal-wide">
        <div class="form-inline">
            <span class="header4">Create Group</span>
        </div>
    </div>
    <div class="modal-body">
        <div class="creation-modal-content">
            <form name="addGrpForm" class="form-horizontal" novalidate>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addGrpForm.inputGroupName.$valid}">
                    <label class="col-md-3 control-label">Group Name*</label>
                    <div class="controls col-md-9">
                        <input class="form-control" type="text" ng-model="grpName" name="inputGroupName" id="inputGroupName" required/>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addGrpForm.grPosition.$valid}">
                    <label class="col-md-3 control-label">Position*</label>
                    <div class="controls col-md-9">
                        <select ng-model="position" class="form-control input-sm" ng-change="selectPos()" class="point" required id="grPosition" name="grPosition">
                            <option ng-show="groupParent.type==='message'" ng-repeat="child in groupParent.children"> {{child.position}}
                                <option ng-show="groupParent.obj && groupParent.obj.type==='group'" ng-repeat="child in groupParent.children"> {{child.obj.position}}
                                    <option value="{{groupParent.children.length+1}}">{{groupParent.children.length+1}}
                        </select>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addGrpForm.grUsage.$valid}">
                    <label class="col-md-3 control-label">Usage*</label>
                    <div class="controls col-md-9">
                        <select class="form-control input-sm" name="grUsage" id="grUsage" ng-change="selectUsage(newGroup.usage)" ng-model="newGroup.usage" ng-options="usage for usage in config.usages" required />
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addGrpForm.grCardMin.$valid ||!addGrpForm.grCardMax.$valid }">
                    <label class="col-md-3 control-label">Cardinality*</label>
                    <div class="controls col-md-9">
                        <span class="form-inline">
                                                <input  style="width:49%;margin-right: 1px" class="form-control"
                                                    placeholder="Min"
                                                       name="grCardMin"
                                                       id="grCardMin"
                                                       ng-change="setDirty()"
                                                       ng-pattern="/^\d+$/"
                                                       ng-model="newGroup.min" ng-disabled="disableMin" required >
                                                <input  style="width:50%" class="form-control" type="text"
                                                    placeholder="Max"
                                                       name="grCardMax"
                                                       id="grCardMax"
                                                       ng-change="setDirty()"
                                                       
                                                       ng-pattern="/^\d+$|^\*?$/"
                                                       ng-model="newGroup.max" ng-disabled="disableMax" required>
                                            </span>
                    </div>
                </div>
                <div class="form-group control-group">
                    <label class="col-md-3 control-label">Comment</label>
                    <div class="controls col-md-9">
                        <textarea class="form-control" ng-model="newGroup.comment">
                    </textarea>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-raised btn-default btn-md" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
                &nbsp; </i>Cancel</span>
            </button>
            <button class="btn btn-raised btn-info btn-md" ng-click="addGroup()" ng-disabled="addGrpForm.$invalid"><span><i
                    class="fa fa-plus fa-fw">
                &nbsp; </i>Add</span>
            </button>
        </div>
    </div>
</script>
<script type="text/ng-template" id="SelectSegmentFlavor.html">
    <div class="modal-header modal-wide">
        <div class="form-inline">
            <span class="header4 pull-left">Segment Selection: {{getSegmentLabel(currentSegment)}}</span>
        </div>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-md-12">
                <div class="container-testcase">
                    <div ng-show="results != null && results.length > 0">
                        <table st-table="tmpResults" st-safe-src="results" class="table table-striped table-bordered table-condensed igl-list-table">
                            <thead>
                                <tr>
                                    <th colspan="1" st-ratio="100">
                                        <input st-search placeholder="Search" class="input-sm form-control" type="search" />
                                    </th>
                                </tr>
                                <tr class="tbl-header">
                                    <th st-ratio="100" st-sort="ext">Label</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="row in tmpResults | orderBy:'row.ext'" ng-class="{'active':selection.selected != null && selection.selected === row.id}">
                                    <td st-ratio="100">{{$index + 1}}
                                        <input type="radio" ng-model="selection.selected" ng-value="row.id" ng-click="selectSegment(row)"> {{getSegmentLabel(row)}}
                                    </td>
                                    <!--<td st-ratio="60">{{row.hl7Version}}</td>-->
                                    <!--<td st-ratio="40">{{row.libraryName}}</td>-->
                                </tr>
                            </tbody>
                            <tfoot ng-show="results.length >= 10">
                                <tr>
                                    <td colspan="1">
                                        <div st-pagination="" st-items-by-page="10" st-displayed-pages="7"></div>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    <div ng-show="results == null || results.length == 0">
                        No Segment Flavor Available
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <div class="row">
                <div class="col-md-12">
                    <div class="pull-right">
                        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
                            &nbsp; </i>Cancel</span>
                        </button>
                        <button class="btn btn-raised btn-primary btn-sm" ng-click="submit()" ng-disabled="selection.selected === null || selection.selected=== currentSegment.id"><span><i
                                class="fa fa-play fa-fw">
                            &nbsp; </i>Bind</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/ng-template" id="ConfirmMessageDeleteCtrl.html">
    <div class="modal-header modal-wide">
        <p class="modal-title" style="font-size:20px; font-weight:bold"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>Delete Confirmation
        </p>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to delete Message {{::messageToDelete.name}} ? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="DeleteSegmentRefOrGrp.html">
    <div class="modal-header">
        <p class="modal-title" style="font-size:20px; font-weight:bold"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>Delete Confirmation
        </p>
    </div>
    <div class="modal-body">
        <p ng-show="segOrGrpToDelete.obj.type==='segmentRef'">Are you sure you want to delete Segment Ref: {{::segOrGrpToDelete.obj.ref.name}} ? </p>
        <p ng-show="segOrGrpToDelete.obj.type==='group'">Are you sure you want to delete Group: {{::segOrGrpToDelete.obj.name}} ? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="OtoX.html">
    <div class="modal-header">
        <p class="modal-title" style="font-size:20px; font-weight:bold"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>Change Usage O to X Confirmation
        </p>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to change Usage from O to X and Cardinality form 0..1(*) to 0..0 ? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-primary btn-sm" ng-click="confirm(message)"><span><i class="fa fa-check fa-fw">&nbsp; </i>OK</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="redirectCtrl.html">
    <div class="modal-header">
        <p class="modal-title" style="font-size:20px; font-weight:bold"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>Confirmation
        </p>
    </div>
    <div class="modal-body">
        <p ng-show="destination.type!=='table'">Are you sure you want to leave this page and go to {{::destination.type}} : {{::destination.name}} </p>
        <p ng-show="destination.type==='table'">Are you sure you want to leave this page and go to the Value Set : {{::destination.bindingIdentifier}}</p>

    </div>

    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-primary btn-sm" ng-click="confirm()"><span><i class="fa fa-check fa-fw">&nbsp; </i>Leave</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="DeleteMessagePredicate.html">
    <div class="modal-header">
        <h3 class="modal-title">Delete Confirmation</h3>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to delete the predicate? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>