<style id="antiClickjack">
    body {
        display: none !important;
    }
</style>
<script type="text/javascript">
    if (self === top) {
        var antiClickjack = document.getElementById("antiClickjack");
        antiClickjack.parentNode.removeChild(antiClickjack);
    } else {
        top.location = self.location;
    }
</script>
<script type="text/ng-template" id="EditSegments.html">
    <div ng-controller="SegmentListCtrl" ng-init="init()" class="container">
        <div ng-show="loadingSelection" style="text-align: center;">
            <i class="fa fa-spinner fa-pulse fa-align-center fa-4x"></i>
        </div>
        <div ng-show="!loadingSelection">
            <div ng-show="segment !== null" id="executionPanel">
                <div class="row" style="margin-left:0px; margin-right: 10px">
                    <div class="page-header" style="margin-bottom: 20px">
                        <span class="header4">Segment: {{getSegmentLabel(segment)}}</span>
                        <span class="pull-right">
                            <button title="Save Changes" type="button" class="btn btn-raised btn-sm btn-success"
                                    ng-disabled="editForm.$invalid || !editForm.$dirty"
                                    ng-hide="viewSettings.tableReadonly || segment.scope !== 'USER'"
                                    ng-click="save()">
                                <span><i class="fa fa-check fa-fw"></i> Save</span>
                            </button>
                            <button title="Save Changes" type="button" class="btn btn-raised btn-sm btn-success" ng-disabled="!editForm.$dirty" ng-show="segment.scope !== 'USER'" ng-click="saveBindingForSegment();cleanState();">
                                <span><i class="fa fa-check fa-fw"></i> Save</span>
                            </button>
                            <button title="Reset Changes" type="button" class="btn btn-raised btn-sm btn-warning" ng-show="segment.scope !== 'USER'" ng-disabled="!editForm.$dirty" ng-click="reset()">
                                <span><i class="fa fa-times fa-fw"></i> Reset</span>
                            </button>
                            <button title="Reset Changes" type="button" class="btn btn-raised btn-sm btn-warning" ng-hide="viewSettings.tableReadonly || segment.scope !== 'USER'" ng-disabled="!editForm.$dirty" ng-click="reset()">
                                <span><i class="fa fa-times fa-fw"></i> Reset</span>
                            </button>
                        </span>
                    </div>
                    <div class="col-md-12" ng-controller="cmpSegmentCtrl as cmp">
                        <tabset active="tabStatus.active">
                            <tab ng-click="setDeltaToF()">
                                <tab-heading>
                                    <i class="fa fa-info-circle fa-fw" aria-hidden="true"></i> Segment MetaData
                                </tab-heading>
                                <div style="margin-top: 20px">
                                    <div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.name.$invalid}">
                                        <label class="col-md-2 control-label">Name*</label>
                                        <div class="controls col-md-10">
                                            <input type="text" disabled name="identifier" class="form-control" ng-model="segment.name" ng-change="setDirty()" required>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.ext.$invalid}" ng-hide="segment.scope === 'HL7STANDARD'">
                                        <label class="col-md-2 control-label">Extension</label>
                                        <div class="controls col-md-10">
                                            <input type="text" ng-disabled="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')" class="form-control" ng-change="setDirty()" name="label" class="form-control" ng-model="segment.ext" required required aria-describedby="helpBlock2">
                                            <span id="helpBlock2" class="help-block" style="color:red" ng-show="isDuplicatedTwoContexts(segment,'name', 'ext', segments)">Extension already used</span>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.description.$invalid}">
                                        <label class="col-md-2 control-label">Description</label>
                                        <div class="controls col-md-10">
                                            <input type="text" disabled ng-change="setDirty()" name="description" class="form-control" ng-model="segment.description" required>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.description.$invalid}">
                                        <label class="col-md-2 control-label">Hl7 Version</label>
                                        <div class="controls col-md-10">
                                            <input type="text" disabled name="hl7Versions" class="form-control" ng-model="segment.hl7Version" required>
                                        </div>
                                    </div>
                                    <div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.comment.$invalid}">
                                        <label class="col-md-2 control-label">Comment</label>
                                        <div class="controls col-md-10">
                                            <textarea rows="3" cols="20" ng-disabled="viewSettings.tableReadonly || segment.scope === 'HL7STANDARD' || segment.scope === 'MASTER'" ng-change="setDirty()" name="comment" id="comment" class="form-control" ng-model="segment.comment" />
                                        </div>
                                    </div>
                                    <!--<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.text1.$invalid}">-->
                                        <!--<label class="col-md-2 control-label">Definition Pre-Text</label>-->
                                        <!--<div class="controls col-md-10">-->
                                            <!--<div ng-show="!viewSettings.tableReadonly && segment.scope === 'USER'">-->
                                                <!--<textarea froala="froalaEditorOptions" ng-model="segment.text1" id="text1" name="text1" ng-change="setDirty()"></textarea>-->
                                            <!--</div>-->
                                            <!--<div ng-show="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">-->
                                                <!--<div froala-view="segment.text1"></div>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="form-group control-group" ng-class="{'igl-has-error has-feedback' : editForm.text2.$invalid}">-->
                                        <!--<label class="col-md-2 control-label">Definition Post-Text</label>-->
                                        <!--<div class="controls col-md-10">-->
                                            <!--<div ng-show="!viewSettings.tableReadonly && segment.scope === 'USER'">-->
                                                <!--<textarea froala="froalaEditorOptions" ng-model="segment.text2" id="text2" name="text2" ng-change="setDirty()"></textarea>-->
                                            <!--</div>-->
                                            <!--<div ng-show="viewSettings.tableReadonly || (segment.scope === 'MASTER' || segment.scope === 'HL7STANDARD')">-->
                                                <!--<div class="fr-view">-->
                                                    <!--<div froala-view="segment.text2"></div>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->

                                    <div class="form-group control-group" ng-hide="segment.scope === 'HL7STANDARD'"
                                         >
                                        <label class="col-md-2 control-label">Date Updated</label>

                                        <div class="controls col-md-10">
                                            <span
                                                    class="form-control">{{segment.dateUpdated | date:dateFormat}}</span>
                                        </div>
                                    </div>

                                </div>
                            </tab>
                            <tab ng-click="setDeltaToF()">
                                <tab-heading>
                                    <i class="fa fa-table fa-fw" aria-hidden="true"></i> Segment Definition
                                </tab-heading>
                                
                                <div class="el-def" style="margin-top: 5px">
                                    <accordion>


                                    <div accordion-group class="panel-primary panel-level1" is-open="accordStatus.isFifthOpen">
                                        <accordion-heading>
                                            <span style="color:white;">Definition Pre-Text</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isFifthOpen, 'fa-chevron-right': !accordStatus.isFifthOpen}"></i>                                                </accordion-heading>
                                        <div class="panel-body">
                                            <div ng-show="!viewSettings.tableReadonly && segment.scope === 'USER'">
                                                <textarea froala="froalaEditorOptions" ng-model="segment.text1" id="text1" name="text1" ng-change="setDirty()"></textarea>
                                            </div>
                                            <div ng-show="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                <div froala-view="segment.text1"></div>
                                            </div>
                                        </div>
                                    </div>

                                        <div accordion-group class="panel-primary panel-level1" is-open="accordStatus.isFirstOpen">
                                            <accordion-heading>
                                                <span style="color:white;">Segment Definition </span><i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isFirstOpen, 'fa-chevron-right': !accordStatus.isFirstOpen}"></i>
                                            </accordion-heading>
                                            <div class="" style="margin:5px 5px 5px 5px">
                                                 <div class="pull-left">
                                                    <div ng-dropdown-multiselect=""
                                                        options="viewSettings.columnOptions"
                                                        selected-model="viewSettings.visibleColumns"
                                                        events="viewSettings.events" extra-settings="viewSettings.extra"
                                                        translation-texts="viewSettings.translations"></div>
                                                </div>
                                                <div class="pull-right">
                                                    <div class="btn-group">
                                                        <button ng-show="segment.scope!=='HL7STANDARD' && !viewSettings.tableReadonly"
                                                            ng-click="addFieldModal(segment)" type="button" class="btn btn-raised btn-info btn-sm">
                                                        <span><i class="glyphicon glyphicon-plus"></i> Add Field</span>
                                                        </button>
                                                    </div>
                                                </div>
                                                  <div class="igl-def-table-container">
                                                    <table id="treeTable" tt-table tt-params="segmentsParams" class="table table-bordered table-fix-header table-condensed profile-table">
                                                        <thead>
                                                            <tr class="tbl-header" style="">
                                                                <th class="col-md-2 col-fixed-250">Name</th>
                                                                <th class="col-md-1 col-fixed-80" >Usage
                                                                    <button type="button" ng-show="(segment.scope === 'USER') && !viewSettings.tableReadonly && (segment.fields.length>0)" class="btn btn-raised btn-info btn-xs" ng-click="OtoX(segment)">O to X
                                                                    </button>
                                                                </th>
                                                                <th class="col-md-1 col-fixed-100">Cardinality
                                                                </th>
                                                                <th class="col-md-1 col-fixed-100">Length
                                                                </th>
                                                                <th class="col-md-1 col-fixed-80">Conformance Length
                                                                </th>
                                                                <th class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">Data Type
                                                                </th>
                                                                <th class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">Value Set
                                                                </th>
                                                                <th class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
                                                                    Predicate
                                                                </th>
                                                                <th class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
                                                                    Conformance Statement
                                                                </th>
                                                                <th class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">Definition Text
                                                                </th>
                                                                <th class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
                                                                    Comment
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody></tbody>
                                                    </table>
                                                     </div>
                                            </div>
                                            
                                        </div>

                                    <div accordion-group class="panel-primary panel-level1" is-open="accordStatus.isSixOpen">
                                        <accordion-heading>
                                            <span style="color:white;">Definition Post-Text</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isSixOpen, 'fa-chevron-right': !accordStatus.isSixOpen}"></i>                                                </accordion-heading>
                                        <div class="panel-body">
                                            <div ng-show="!viewSettings.tableReadonly && segment.scope === 'USER'">
                                                <textarea froala="froalaEditorOptions" ng-model="segment.text2" id="text2" name="text2" ng-change="setDirty()"></textarea>
                                            </div>
                                            <div ng-show="viewSettings.tableReadonly || (segment.scope === 'MASTER' || segment.scope === 'HL7STANDARD')">
                                                <div class="fr-view">
                                                    <div froala-view="segment.text2"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                        <div accordion-group class="panel-primary panel-level1" is-open="accordStatus.isSecondOpen">
                                            <accordion-heading>
                                                <span style="color:white;">Conformance Statements</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isSecondOpen, 'fa-chevron-right': !accordStatus.isSecondOpen}"></i> </accordion-heading>
                                            <div class="panel-body">
                                                    <div class="col-md-12 igl-page-header">
                                                                <span class="pull-right">
                                                                    <button class="btn btn-raised btn-info btn-sm" ng-click="manageConformanceStatement(null);"  type="button"
                                                                            ng-hide="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                                        <span><i class="fa fa-plus fa-fw">&nbsp; </i>Add Conf.Statement</span></button>
                                                                </span>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <!--<span ng-hide="segment.conformanceStatements.length > 0">No conformance statement</span>-->
                                                        <table st-table="displayed" st-safe-src="segment.conformanceStatements" class="table table-striped table-bordered table-condensed" ng-show="segment.conformanceStatements.length > 0">
                                                            <thead>
                                                                <tr class="tbl-header">
                                                                    <th st-sort="constraintId" class="col-md-1">ID</th>
                                                                    <th st-sort="constraintTarget" class="col-md-3">Location</th>
                                                                    <th class="col-md-7">Description</th>
                                                                    <th class="col-md-1"></th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="c in displayed">
                                                                    <td class="col-md-1">{{c.constraintId}}</td>
                                                                    <td class="col-md-3">
                                                                        <span ng-bind="displayLocationForSegment(segment, c.constraintTarget)" />
                                                                    </td>
                                                                    <td class="col-md-7">{{c.description}}</td>
                                                                    <td class="col-md-1" align="center">
                                                                        <button class="btn btn-raised btn-danger btn-xxs" ng-click="segment.conformanceStatements.splice(segment.conformanceStatements.indexOf(c), 1);" ng-hide="viewSettings.tableReadonly"><span><i class="fa fa-trash fa-fw">
                                                                                &nbsp; </i>Del</span>
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                               
                                            </div>
                                        </div>
                                        <div accordion-group class="panel-primary panel-level1" is-open="accordStatus.isThirdOpen">
                                            <accordion-heading>
                                                <span style="color:white;">Conditional Predicates</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isThirdOpen, 'fa-chevron-right': !accordStatus.isThirdOpen}"></i>
                                            </accordion-heading>
                                            <div class="panel-body">
                                                <div class="col-md-12 igl-page-header">
                                                                    
                                                                    <span class="pull-right">
                                                    <button class="btn btn-raised btn-info btn-sm" ng-click="managePredicate(null);"  type="button"
                                                            ng-hide="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                        <span><i class="fa fa-plus fa-fw">&nbsp; </i>Add Predicate</span></button>
                                                                    </span>
                                                </div>
                                                <div class="col-md-12">
                                                    <!--<span ng-hide="segment.predicates.length > 0">No Conditional Predicate</span>-->
                                                    <table st-table="displayed" st-safe-src="segment.predicates" class="table table-striped table-bordered table-condensed" ng-show="segment.predicates.length > 0">
                                                        <thead>
                                                            <tr class="tbl-header">
                                                                <th st-sort="constraintTarget" class="col-md-3">Location</th>
                                                                <th class="col-md-6">Description</th>
                                                                <th class="col-md-1">True usage</th>
                                                                <th class="col-md-1">False usage</th>
                                                                <th class="col-md-1"></th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="p in displayed">
                                                                <td class="col-md-3">
                                                                    <span ng-bind="displayLocationForSegment(segment, p.constraintTarget)" />
                                                                </td>
                                                                <td class="col-md-6">{{p.description}}</td>
                                                                <td class="col-md-1">{{p.trueUsage}}</td>
                                                                <td class="col-md-1">{{p.falseUsage}}</td>
                                                                <td class="col-md-1" align="center">
                                                                    <button class="btn btn-raised btn-danger btn-xxs" ng-click="segment.predicates.splice(segment.predicates.indexOf(p), 1);" ng-disabled="viewSettings.tableReadonly"><span><i class="fa fa-trash fa-fw">
                                                                        &nbsp; </i>Del</span>
                                                                    </button>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <div accordion-group class="panel-primary panel-level1" is-open="accordStatus.isFourthOpen">
                                            <accordion-heading>
                                                <span style="color:white;"> Co-Constraints</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': accordStatus.isFourthOpen, 'fa-chevron-right': !accordStatus.isFourthOpen}"></i>
                                            </accordion-heading>
                                            <div class="panel-body">
                                                <div class="col-md-12 igl-page-header">
                                                        
                                                        <span class="pull-right">
                                                            <button ng-hide="segment.coConstraints.columnList.length == 0" class="btn btn-raised btn-danger btn-sm" ng-click="deleteCoConstraints();">
                                                                <span><i class="fa fa-trash fa-fw">&nbsp; </i>Delete Co-Constraint</span>
                                                            </button>
                                                            <button class="btn btn-raised btn-info btn-sm" ng-show="segment.coConstraints.columnList.length == 0" ng-click="manageCoConstaintsTableModal(segment);" ng-disabled="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                                <span><i class="fa fa-plus fa-fw">&nbsp; </i>Create Co-Constraint</span>
                                                            </button>
                                                            <button class="btn btn-raised btn-info btn-sm" ng-show="segment.coConstraints.columnList.length > 0" ng-click="manageCoConstaintsTableModal(segment);" ng-disabled="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                                <span><i class="fa fa-pencil fa-fw">&nbsp; </i>Edit Co-Constraint</span>
                                                            </button>
                                                        </span>
                                                </div>
                                                <div class="col-md-12">
                                                    <div ng-hide="segment.coConstraints.columnList.length == 0" class="table-container">
                                                        <span class="pull-right">
                                                            <button class="btn btn-raised btn-info btn-xs" ng-click="addCoConstraint();" ng-hide="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                                <span><i class="fa fa-plus fa-fw">&nbsp; </i>Add Value</span>
                                                            </button>
                                                        </span>
                                                        <table st-table="rowCollection" class="table table-striped table-bordered table-condensed">
                                                            <thead>
                                                                <tr class="tbl-header">
                                                                    <th class="col-md-1" lr-drag-src="headers" lr-drop-target="headers" ng-repeat="col in segment.coConstraints.columnList" st-sort="{{col}}">
                                                                        <span class="glyphicon glyphicon-move"></span> {{segment.name}}-{{col.field.position}}
                                                                        <a ng-click="deleteColumn(col)" class="point" class="btn btn-raised btn-xs btn-danger">
                                                                            <i class="fa fa-times fa-fw"></i>
                                                                        </a>
                                                                    </th>
                                                                    <th class="col-md-2">Description</th>
                                                                    <th class="col-md-2">Comments</th>
                                                                    <th class="col-md-1" align="right"/>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="cc in segment.coConstraints.constraints">
                                                                    <td class="col-md-1" ng-repeat="col in segment.coConstraints.columnList">
                                                                        <input ng-show="col.constraintType === 'v'" class="form-control" ng-model="cc.values[col.columnPosition].value" ng-change="recordChange()" type="text" ng-disabled="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')"/>
                                                                        <select ng-show="col.constraintType === 'vs'" ng-model="cc.values[col.columnPosition].value" class="form-control" ng-change="recordChange()" ng-disabled="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')" ng-options="link.id as tablesMap[link.id].bindingIdentifier+'-'+ tablesMap[link.id].description for link in igdocument.profile.tableLibrary.children | orderBy:'bindingIdentifier'">
                                                                            <option value="">N/A</option>
                                                                        </select>
                                                                    </td>
                                                                    <td class="col-md-2">
                                                                        <textarea rows="2" cols="20" ng-disabled="viewSettings.tableReadonly || segment.scope === 'HL7STANDARD' || segment.scope === 'MASTER'" ng-change="setDirty()" class="form-control" ng-model="cc.description" />
                                                                    </td>
                                                                    <td class="col-md-2">
                                                                        <textarea rows="2" cols="20" ng-disabled="viewSettings.tableReadonly || segment.scope === 'HL7STANDARD' || segment.scope === 'MASTER'" ng-change="setDirty()" class="form-control" ng-model="cc.comments" />
                                                                    </td>
                                                                    <td class="col-md-1">
                                                                        <button class="btn btn-raised btn-danger btn-xs" ng-click="deleteCoConstraint(cc);" ng-hide="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                                                                            <span><i class="fa fa-trash fa-fw">&nbsp; </i>Del</span></button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                    </accordion>
                                    
                                </div>
                                
                                
                                
                            </tab>
                            <tab ng-click="callSegDelta()">
                                <tab-heading>
                                    <i class="fa fa-table fa-fw" aria-hidden="true"></i> Segment Delta
                                </tab-heading>
                                <div class="panel-body" style="margin:5px;">
                                    <accordion>
                                        <div accordion-group class="panel-primary panel-level1" is-open="status.isFirstOpen">
                                            <accordion-heading>
                                                <span style="color:white;"> Delta Configuration</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': status.isFirstOpen, 'fa-chevron-right': !status.isFirstOpen}"></i>
                                            </accordion-heading>

                                            <table class="table table-stripped table-borderless table-condensed">
                                                <thead>
                                                <tr class="tbl-header">
                                                    <th class="col-md-1"></th>
                                                    <th class="col-md-2">HL7 Version</th>
                                                    <th class="col-md-2">Scope</th>
                                                    <th class="col-md-3">IG Document</th>
                                                    <th class="col-md-4">Segment</th>
                                                </thead>

                                                <tbody>

                                                <tr>
                                                    <td class="col-md-1">
                                                        <span class="label" style="background-color:#B5F7EC;color:black;">1</span>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="version1" class="form-control" disabled>
                                                            <option ng-selected="version1"> {{version1}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="scope1" class="form-control" disabled>
                                                            <option ng-selected="scope1"> {{scope1}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-3">
                                                        <select ng-model="ig1" class="form-control" disabled>
                                                            <option ng-selected="ig1"> {{ig1}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-4">
                                                        <select ng-model="segment1" class="form-control" disabled>
                                                            <option ng-selected="segment1"> {{getLabel(segment1)}}</option>
                                                        </select>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td class="col-md-1">
                                                        <span class="label" style="background-color:#EDE1AF;color:black;">2</span>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="version2" class="form-control" ng-change="setVersion2(version2)" no-dirty-check>
                                                            <option ng-repeat="vr in versions" value='{{vr}}' ng-selected="vr===version2"> {{vr}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-2">
                                                        <select ng-model="scope2" class="form-control" ng-change="setScope2(scope2)" no-dirty-check>
                                                            <option ng-repeat="scope in scopes" value='{{scope.name}}' ng-selected="scope.name===scope2"> {{scope.alias}}</option>
                                                        </select>
                                                    </td>
                                                    <td class="col-md-3">
                                                        <select class="form-control" ng-options="ig as ig.title for ig in igList2 track by ig.id" ng-model="ig2" ng-change="setIG2(ig2)" ng-disabled="!scope2 || !version2 || igDisabled2" no-dirty-check></select>
                                                    </td>
                                                    <td class="col-md-4">
                                                        <select ng-model="cmp.segmentId" class="form-control" ng-change="setSegment2(cmp.segmentId)" ng-disabled="!ig2" no-dirty-check>
                                                            <option value='-1'></option>
                                                            <option ng-repeat="segment in segments2 " ng-disabled="disableSeg(segment,segment1)" ng-hide="hideSeg(segment,segment1)" value='{{$index}}'> {{getLabel(segment)}}</option>
                                                        </select>
                                                    </td>

                                                </tr>


                                                </tbody>

                                  </table>
                                            <div class="" align="center" style="margin-bottom:10px">
                                                <button ng-click="cmpSegment(segment1,segment2)" ng-disabled="!segment1 || !segment2||!segChanged" class="btn btn-raised btn-info btn-md">
                                                        <i class="fa fa-check"></i> Delta</button>
                                            </div>
                                        </div>
                                        <div accordion-group class="panel-primary panel-level1" is-open="status.isSecondOpen">
                                            <accordion-heading>
                                                <span style="color:white;"> Delta Result</span> <i class="pull-left fa" style="color:white;" ng-class="{'fa-chevron-down': status.isSecondOpen, 'fa-chevron-right': !status.isSecondOpen}"></i> </accordion-heading>
                                            </accordion-heading>
                                            <div class="panel-body">
                                                <table tt-table tt-params="dynamicSeg_params" class=" table-marginless table-bordered table-condensed">
                                                    <thead>
                                                        <tr class="tbl-header">
                                                            <th class="col-md-1" rowspan="2" style="width:14%;">Position</th>
                                                            <th class="col-md-2" rowspan="2" style="width:37%;">Name</th>
                                                            <th class="col-md-1" rowspan="2" style="width:2%">Usage</th>
                                                            <th class="col-md-1" colspan="2" style="width:4%">Cardinality</th>
                                                            <th class="col-md-1" colspan="2" style="width:4%">Length</th>
                                                            <th class="col-md-1" rowspan="2" style="width:2%">Conformance Length</th>
                                                            <th class="col-md-1" rowspan="2" style="width:21%">Data Type</th>
                                                            <th class="col-md-1" rowspan="2" style="width:16%">Value Set</th>
                                                        </tr>
                                                        <tr class="tbl-header">
                                                            <th class="col-md-1 col-fixed-10" style="width:2%">min</th>
                                                            <th class="col-md-1 col-fixed-10" style="width:2%">max</th>
                                                            <th class="col-md-1 col-fixed-10" style="width:2%">min</th>
                                                            <th class="col-md-1 col-fixed-10" style="width:2%">max</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </accordion>




                                </div>

                            </tab>
                            
                            <tab ng-click="setDeltaToF()">
                                <tab-heading>
                                    <i class="fa fa-link" aria-hidden="true"></i> Segment Cross-References <span class="badge">{{references.length}}</span>
                                </tab-heading>
                                <div class="el-def" style="margin-top:20px">
                                    <span class="pull-right" style="margin-bottom:10px">
                                        <button type="button" ng-click="AddBindingForSegment(segment)" class="btn btn-raised btn-info btn-md"><i class="fa fa-plus"></i> Add Binding</button>
                                    </span>
                                    <div ng-show="references != null && references.length > 0">
                                        <table st-table="tmpReferences" st-safe-src="references" class="table table-striped table-bordered table-condensed">
                                            <thead>
                                            <tr class="tbl-header">
                                                <td st-ratio="5">#</td>
                                                <th st-ratio="20">Position Path</th>
                                                <th st-ratio="40">Path</th>
                                                <th st-ratio="10">Usage</th>
                                                <th st-ratio="20">Segment</th>
                                                <th st-ratio="5">Status</th>
                                            </tr>

                                            </thead>

                                            <tbody>
                                            <tr ng-repeat="ref in tmpReferences">
                                                <td st-ratio="5">{{$index + 1}}
                                                </td>
                                                <td st-ratio="20">
                                                    <span ng-bind="ref.positionPath"></span>
                                                </td>
                                                <td st-ratio="40">
                                                    <span ng-bind="ref.path"></span>
                                                </td>
                                                <td st-ratio="10">
                                                    {{::ref.usage}}
                                                </td>
                                                <td st-ratio="20">
                                                    <select class="form-control" ng-change="changeSegmentLink(ref.segmentLink)" ng-model="ref.segmentLink.id">
                                                        <option ng-repeat="seg in segments |orderBy:'+name'" ng-hide="seg.name != segment.name" value="{{seg.id}}">
                                                            {{::getSegmentLabel(seg)}}
                                                        </option>
                                                    </select>
                                                </td>
                                                <td st-ratio="5">
                                                    <span ng-show="ref.segmentLink.isNew">New</span>
                                                    <span ng-show="!ref.segmentLink.isNew && ref.segmentLink.isChanged">Changed</span>
                                                </td>

                                            </tr>
                                            </tbody>
                                            <tr ng-show="references.length > 15">
                                                <td colspan="6" class="text-center">
                                                    <div st-pagination="" st-items-by-page="15" st-displayed-pages="15"></div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div ng-hide="references != null && references.length > 0">
                                        <p>This Segment is not being used in this ig document</p>
                                    </div>

                                </div>
                            </tab>
                        </tabset>
                    </div>
            </div>
        </div>
        

    </div>
    </div>
</script>
<script type="text/ng-template" id="ManageCoConstraintsTableModal.html">
    <div class="modal-header">
        <div class="form-inline">
            <span class="header4">Co-Constraints Table</span>
        </div>
    </div>
    <div class="modal-body">
        <span class="header5">Create Column</span>
        <hr />
        <div class="row">
            <div class="col-md-12">
                <form class="form-inline">
                    <div class="form-group">
                        <label class="">Field</label>
                        <select class="form-control" name="newColumnField" style="width:300px" ng-model="newColumnField">
                            <option value="">Select Field</option>
                            <option ng-repeat="field in selectedSegment.fields" value="{{field}}" ng-disabled="checkFieldExisting(field)">{{::segment.name + '-' + field.position + ' : ' + field.name}}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="">Constraint Type</label>
                        <select class="form-control" name="newColumnConstraintType" style="width:300px" ng-model="newColumnConstraintType">
                            <option value="">Select Constraint Type</option>
                            <option value="v">Value</option>
                            <option value="vs">Value Set</option>
                        </select>
                    </div>
                    <button ng-disabled="newColumnField === null || newColumnConstraintType ===null || newColumnField === '' || newColumnConstraintType ===''" class="btn btn-raised btn-info btn-sm" ng-click="addColumnCoConstraints();" ng-disabled="viewSettings.tableReadonly || (segment.scope !== 'USER' && segment.scope !== 'MASTER')">
                        <span><i class="fa fa-plus fa-fw">&nbsp; </i>Add Column</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="table-container" style="margin-top: 40px">
                    <span class="header5">Table Structure</span>
                    <hr />
                    <table st-table="rowCollection" class="table table-striped table-bordered table-condensed">
                        <thead>
                            <tr class="tbl-header">
                                <th class="col-md-1" lr-drag-src="headers" lr-drop-target="headers" ng-repeat="col in selectedSegment.coConstraints.columnList" st-sort="{{col}}">
                                    <span class="glyphicon glyphicon-move"></span> {{::selectedSegment.name}}-{{::col.field.position}}
                                    <a class="btn btn-raised btn-xs btn-danger" ng-click="deleteColumn(col)">
                                        <i class="fa fa-times fa-fw"></i>
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="col-md-1" ng-repeat="col in selectedSegment.coConstraints.columnList">
                                    <select class="form-control" style="width:30%" ng-model="col.constraintType">
                                        <option value="v">Value</option>
                                        <option value="vs">Value Set</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="row">
            <div class="col-md-12">
                <button class="btn btn-raised btn-default btn-sm" ng-click="close()"><span><i class="fa fa-times fa-fw">
        &nbsp; </i>Cancel</span></button>
                <button class="btn btn-raised btn-success btn-sm" ng-click="saveAndClose()"><span><i class="fa fa-check fa-fw">
        &nbsp; </i>Save</span></button>
            </div>
        </div>
</script>
<script type="text/ng-template" id="SegmentEditTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="isVisible(node)">
        <td class="col-md-2 col-fixed-250">
            <span ng-show="node.type==='field'" class="label label-field label-icon">F</span>
            <span ng-show="node.type==='component'" class="label label-component label-icon">C</span>
            <span ng-show="node.type==='subcomponent'" class="label label-sub-component label-icon">S</span>
            <span style="width:60%">{{::node.name}}:</span>
            <span ng-bind="node.description"></span>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>-</div>
        </td>
        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div>-</div>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
         </td>
    </tr>
</script>
<script type="text/ng-template" id="SegmentReadTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="isVisible(node)">
        <td class="col-md-2 col-fixed-250">
            <span ng-show="node.type==='field'" class="label label-field label-icon">F</span>
            <span ng-show="node.type==='component'" class="label label-component label-icon">C</span>
            <span ng-show="node.type==='subcomponent'" class="label label-sub-component label-icon">S</span>
            <span style="width:60%">{{::node.name}}:</span>
            <span ng-bind="node.description"></span>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol" ng-show="viewSettings.isVisibleColumn('datatype')">
         </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
         </td>
    </tr>
</script>
<script type="text/ng-template" id="SegmentCaseReadTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="isVisible(node)">
        <td class="col-md-2 col-fixed-250">
            <span ng-show="node.type === 'case'" class="label label-dynamicCase label-icon">D</span>
            <span ng-bind="node.value"></span>
        </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-80 emptyCol">
         </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            {{getDatatypeLabel(datatypesMap[node.datatype])}}
        </td>
        <td class="col-md-1 col-fixed-130 emptyCol" ng-show="viewSettings.isVisibleColumn('valueSet')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
         </td>
        <td class="col-md-1 emptyCol col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">
         </td>
        <td class="col-md-1 emptyCol" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
         </td>
    </tr>
</script>
<script type="text/ng-template" id="SegmentFieldEditTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="(isVisible(node) &&( node.usage==='R' ||node.usage==='RE' ||node.usage==='C' )&& $root.usageF) || (isVisible(node) && !$root.usageF)" ng-class="{ 'new': isChildNew(node), 'selected': isChildSelected(node)}">
        <td class="col-md-2 col-fixed-250" ng-controller="SegmentRowCtrl">
            <a ng-show="editableField!==node.id" ng-click="editField(node)" class="point">
                <span><i class="fa fa-pencil fa-fw"></i></span>
            </a>
            <a ng-show="editableField!==node.id" ng-click="deleteField(node,segment)" class="point">
                <span><i class="glyphicon glyphicon-trash"></i></span>
            </a>
            <ng-form name="{{formName}}" class="form-inline">
                <!--<input type="checkbox" ng-checked="isChildSelected(node)" ng-click="selectChild($event,node)">-->
                <span class="label label-field label-icon">F</span>
                <span ng-show="editableField!==node.id">
                <span ng-hide="isChildNew(node)"
                      tooltip-html="getFieldNodeName(node)" tooltip-append-to-body="true"
                      tooltip-class="constraints-tooltip" ng-bind-html="getFieldNodeName(node)" tooltip-trigger
                      tooltip-animation="false" tooltip-placement="left"
                        ></span>
                <span ng-show="isChildNew(node)">
                      {{node.position}}.
                    <input
                            class="form-control focus"
                            autofocus
                            style="width:65%"
                            name="name"
                            ng-change="recordDatatypeChange( 'field', 'edit',node.id, 'name', node.name)"
                            ng-class="{ 'igl-has-error has-feedback' : {{formName}}.name.$invalid}"
                            ng-model="node.name" required>
            </span>
                </span>
                <span ng-show="editableField===node.id">
             <select ng-model="position" ng-change="selectPos()" style="width:15%" class="form-control input-sm">
                 <option ng-repeat="child in segment.fields" ng-selected="node.position===child.position">
                     {{child.position}}
             </select>
            

            <input style="width:55%" class="form-control" ng-model="fieldName" type="text"/>
            </span>
                <div align="center">
                    <a ng-show="editableField===node.id && fieldName" ng-click="applyField(segment,node,fieldName,position)" class="point">
                        <span><i class="glyphicon glyphicon-ok"></i></span>
                    </a>
                    <a ng-show="editableField===node.id" ng-click="backField()" class="point">
                        <span><i class="glyphicon glyphicon-remove"></i></span>
                    </a>
                </div>
            </ng-form>
        </td>
        <td class="col-md-1 col-fixed-80">
                 <span ng-show="node.usage !=='C' || (node.usage==='C' && countPredicate(node.position)===0 )" ng-controller="DatatypeRowCtrl">
                <ng-form name="{{formName}}" class="form-inline">
                    <select class="form-control input-sm" name="usage"
                            ng-change="setUsage(node);setCardinalities(node);openPredicateDialog(node);"
                            ng-class="{ 'igl-has-error has-feedback' : {{formName}}.usage.$invalid}"
                            required ng-model="node.usage" ng-options="usage for usage in config.usages"/>
                    </ng-form>
                </span>
                <div ng-show="node.usage==='C' && countPredicate(node.position) !==0">
                    <p ng-repeat="p in segment.predicates | filter:{constraintTarget:node.position + '[1]'}:true">
                        C({{p.trueUsage}}/{{p.falseUsage}})
                    </p>
                    <a ng-click="deletePredicateByPosition(node.position, segment)" class="point">
                        <span title="Delete Predicate and Change Usage"><i class="fa fa-times fa-fw"></i></span>
                    </a>
                </div>
         </td>
        <td class="col-md-1 col-fixed-100">
            <div ng-controller="SegmentRowCtrl">
                <span ng-form name="{{formName}}" class="form-inline">
                                                <input style="width:45%" class="form-control"
                                                       name="min"
                                                       ng-change="setDirty()"
                                                       ng-pattern="/^\d+$/"
                                                       ng-class="{ 'igl-has-error' : {{formName}}.min.$invalid}"
                                                       ng-model="node.min" required ng-minlength="1">
                                                <input style="width:45%" class="form-control" type="text"
                                                       name="max"
                                                       ng-change="setDirty()"
                                                       ng-class="{ 'igl-has-error' : {{formName}}.max.$invalid}"
                                                       ng-pattern="/^\d+$|^\*?$/"
                                                       ng-model="node.max" required>
                                            </span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.datatype.id].components.length == 0" ng-controller="SegmentRowCtrl">
                <span ng-form name="{{formName}}" class="form-inline">
                                                <input style="width:45%" class="form-control"
                                                       name="minLength"
                                                       ng-change="setDirty()"
                                                       ng-pattern="/^\d+$/"
                                                       ng-class="{ 'igl-has-error' : {{formName}}.minLength.$invalid}"
                                                       ng-model="node.minLength" required ng-minlength="1">
                                                <input style="width:45%" class="form-control" type="text"
                                                       name="maxLength"
                                                       ng-change="setDirty()"
                                                       ng-class="{ 'igl-has-error' : {{formName}}.maxLength.$invalid}"
                                                       ng-pattern="/^\d+$|^\*?$/"
                                                       ng-model="node.maxLength" required>
                                            </span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.datatype.id].components.length == 0" ng-controller="SegmentRowCtrl">
                <span ng-form name="{{formName}}" class="form-inline">
                                            <input style="width:50%" class="form-control" type="text"
                                                   name="confLength"
                                                   ng-change="setDirty()"
                                                   ng-class="{ 'igl-has-error' : {{formName}}.confLength.$invalid}"
                                                   ng-pattern="/^\d+$/"
                                                   ng-model="node.confLength">
                                            </span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')" class="form-inline">
            <a class="point" ng-show="editableDT!==node.id" ng-click="redirectDT(node.datatype)">
        {{getDatatypeLabel(datatypesMap[node.datatype.id])}}
    </a>
            <a ng-show="editableDT!==node.id" ng-click="editDT(node)" class="point">
                <span><i class="fa fa-pencil fa-fw"></i></span>
            </a>
            <a ng-show="datatypesMap[node.datatype.id].name === 'varies'" ng-click="showEditDynamicMappingDlg(node)" class="point">
                <span><i class="fa fa-cog" aria-hidden="true"></i></span>
            </a>
            <div ng-show="editableDT===node.id">
                <select ng-model="datatype" ng-change="selectDT(node,datatype)" class="form-control input-sm">
                    <option ng-repeat="datatype in results" value="{{datatype}}" ng-selected="node.datatype.id===datatype.id"> {{getDatatypeLabel(datatype)}} {{::datatype.hl7Version}}
                    </option>
                    <option ng-click="otherDT(node)" value="" ng-show="node.added==='yes'"> Others
                </select>
            </div>
            <div align="center">
                <a ng-show="editableDT===node.id" ng-click="backDT()" class="point">
                    <span><i class="glyphicon glyphicon-remove"></i></span>
                </a>
            </div>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')" style="text-align:center">
            <div ng-show="node.tables.length!==0 && isAvailableDTForTable(datatypesMap[node.datatype.id])">
                <a class="point" ng-repeat="table in node.tables">
                    <span ng-click="redirectVS(table)">{{getTableLabel(tablesMap[table.id])}}</span>
                </a>
                <a ng-click="editVSModal(node)" class="point">
                    <span><i class="fa fa-pencil fa-fw"></i></span>
                </a>

            </div>
            <div ng-show="(node.tables.length===0) && isAvailableDTForTable(datatypesMap[node.datatype.id])">
                <a ng-click="editVSModal(node)" class="point">
                    <span><i class="fa fa-plus fa-fw"></i></span>
                </a>
            </div>
        </td>
        <td class="col-md-1" ng-style="predWidthx" ng-class="{'has-error': node.usage === 'C' && countPredicate(node.position) != 1}" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <div ng-show="countPredicate(node.position)===0 && node.usage==='C'">
                    <a ng-click="managePredicate(node)" class="point">
                        <i class="fa fa-plus fa-fw"></i>
                        <p class="warning">Need predicate</p>
                    </a>
                </div>
                <div ng-show="countPredicate(node.position) !==0 && node.usage==='C'">
                    <p ng-repeat="p in segment.predicates | filter:{constraintTarget:node.position + '[1]'}:true">
                        <a ng-click="managePredicate(node)" tooltip-html="getPredicateAsString(p)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(p)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></a>
                    </p>
                    <div ng-show="countPredicate(node.position) > 1">
                        <p class="warning">Multiple predicates</p>
                    </div>
                </div>
            </div>
        </td>
        <td class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div ng-show="countConformanceStatements(node.position)==0">
                <a ng-click="manageConformanceStatement(node)" class="point">
                    <span><i class="fa fa-plus fa-fw"></i></span>
                </a>
            </div>
            <p ng-repeat="c in segment.conformanceStatements | filter:{constraintTarget:node.position + '[1]'}:true">
                <a ng-click="manageConformanceStatement(node)" tooltip-html="getConformanceStatementAsString(c)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(c)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></a>
            </p>
        </td>
        <td class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')" style="text-align:center">
            <div>
                <a ng-click="openRichTextDlg(node, 'text', 'Definition Text', false)" class="point">
                    <i class="fa fa-pencil fa-fw" ng-show="node.text !=='' && node.text !==null"></i>
                    <i class="fa fa-plus fa-fw" ng-show="node.text==='' || node.text===null"></i>
                </a>
                <a ng-click="node.text=''" ng-show="node.text !=='' && node.text !==null">
                    <i class="fa fa-times fa-fw"></i>
                </a>
            </div>
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')" style="text-align:center">
            <a ng-click="openInputTextDlg(node, 'comment','Comment', false)" class="point"
               tooltip-html="node.comment" tooltip-append-to-body="true"
               tooltip-class="constraints-tooltip"
               tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-pencil fa-fw" ng-show="node.comment !== '' && node.comment !== null"></i>
                <i class="fa fa-plus fa-fw" ng-show="node.comment === '' || node.comment === null"></i>
            </a>
            <a ng-click="clearComments(node,'comment')"  ng-show="node.comment !== '' && node.comment !== null">
                <i class="fa fa-times fa-fw"></i>
            </a>
        </td>
    </tr>
</script>
<script type="text/ng-template" id="tag-template">
    <div>
        <span ng-bind-html="$highlight($getDisplayText())"></span>
        <span>{{data.table.bindingIdentifier}}</span>
    </div>
</script>
<script type="text/ng-template" id="SegmentFieldReadTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="(isVisible(node) &&( node.usage==='R' ||node.usage==='RE' ||node.usage==='C' )&& $root.usageF) || (isVisible(node) && !$root.usageF)">
        <td class="col-md-2 col-fixed-250">
            <span ng-show="node.type==='field'" class="label label-field label-icon">F</span>
            <span ng-show="node.type==='component'" class="label label-component label-icon">C</span>
            <span ng-show="node.type==='subcomponent'" class="label label-sub-component label-icon">S</span>
            <span tooltip-html="getFieldNodeName(node)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getFieldNodeName(node)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <div>
                <span ng-show="node.usage !=='C' || (node.usage==='C' && countPredicate(node.position)===0 )">
                    <span>{{::node.usage}}</span>
                </span>
                <div ng-show="node.usage==='C' && countPredicate(node.position) !==0">
                    <p ng-repeat="p in datatype.predicates | filter:{constraintTarget:node.position + '[1]'}:true">
                        C({{::p.trueUsage}}/{{::p.falseUsage}})
                    </p>
                </div>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100">
            [{{::node.min}}, {{::node.max}}]
        </td>
        <td class="col-md-1 col-fixed-100" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}" >
           <div ng-show="datatypesMap[node.datatype.id].components.length == 0"> [{{::node.minLength}}, {{::node.maxLength}}]</div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}" >
            <div ng-show="datatypesMap[node.datatype.id].components.length == 0"> {{::node.confLength}} </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            <span ng-click="redirectDT(node.datatype)">{{getDatatypeLabel(datatypesMap[node.datatype.id])}}
            </span>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">
            <a class="point" ng-show="node.tables !=undefined && node.tables !==null" ng-repeat="table in node.tables track by table.id" ng-click="redirectVS(table)">{{getTableLabel(tablesMap[table.id])}}

</a>
        </td>
        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <p ng-repeat="p in segment.predicates | filter:{constraintTarget:node.position + '[1]'}:true">
                <span tooltip-html="getPredicateAsString(p)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(p)" tooltip-trigger tooltip-animation="false" tooltip-placement="left" />
            </p>
        </td>
        <td class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <p ng-repeat="c in segment.conformanceStatements | filter:{constraintTarget:node.position + '[1]'}:true">
                <span tooltip-html="getConformanceStatementAsString(c)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(c)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></span>
            </p>
        </td>
        <td class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">
            <a ng-click="openRichTextDlg(node, 'text', 'Definition Text', true)" ng-show="node.text !=='' && node.text !==null" class="point">
                <i class="fa fa-eye fa-fw"></i>
            </a>
            <!--<a ng-click="node.text=''" ng-show="node.text !=='' && node.text !==null">-->
            <!--<i class="fa fa-times fa-fw"></i>-->
            <!--</a>-->
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <!--<span class="form-control" style="width:100%;height:100%" ng-bind="node.comment" ng-show="node.comment !=='' && node.comment !==null" disabled>-->
            <!--</span>-->
            <a ng-click="openInputTextDlg(node, 'comment','Comment', true)" class="point"
               ng-show="node.comment !== '' && node.comment !== null"
               tooltip-html="node.comment" tooltip-append-to-body="true"
               tooltip-class="constraints-tooltip"
               tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ng-show="node.comment !== '' && node.comment !== null"></i>
            </a>

        </td>
    </tr>
</script>
<script type="text/ng-template" id="SegmentComponentEditTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="isVisible(node)">
        <td class="col-md-2 col-fixed-250">
            <span>
                                 <span ng-show="node.type==='field'" class="label label-field label-icon">F</span>
            <span ng-show="node.type==='component'" class="label label-component label-icon">C</span>
            <span ng-show="node.type==='subcomponent'" class="label label-sub-component label-icon">S</span>
            <span tooltip-html="getComponentNodeName(node)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getComponentNodeName(node)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></span>
            </span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <span ng-show="node.usage !=='C' || (node.usage==='C' && countPredicateOnComponent(node.position, node.id)===0 )">
                {{::node.usage}}
            </span>
            <div ng-show="node.usage==='C' && countPredicateOnComponent(node.position, node.id) !==0">
                <p ng-repeat="p in parentsMap[node.id].predicates | filter:{constraintTarget:node.position + '[1]'}:true">
                    C({{::p.trueUsage}}/{{::p.falseUsage}})
                </p>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100">
            <div>
                -
            </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.datatype.id].components.length == 0">
                [{{::node.minLength}},{{::node.maxLength}}]
            </div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}">
            <div ng-bind="node.confLength" ng-show="datatypesMap[node.datatype.id].components.length == 0">
            </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            <div>
                <span ng-click="redirectDT(node.datatype)">{{getDatatypeLabel(datatypesMap[node.datatype.id])}}</span>
            </div>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">
            <div>
                <span ng-show="node.table !=undefined && node.table !=null">
                    <a class="point" ng-show="node.tables !=undefined && node.tables !==null" ng-repeat="table in node.tables" ng-click="redirectVS(table)">{{getTableLabel(tablesMap[table.id])}}
</a>
                </a>
                </span>
            </div>
            <div ng-show="node.type==='segment'">-</div>
        </td>
        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <p ng-repeat="p in parentsMap[node.id].predicates | filter:{constraintTarget:node.position + '[1]'}:true" tooltip-html="getPredicateAsString(p)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(p)"
                    tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div>
                <p ng-repeat="c in parentsMap[node.id].conformanceStatements | filter:{constraintTarget:node.position + '[1]'}:true" tooltip-html="getConformanceStatementAsString(c)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(c)"
                    tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">
            <div>
                <a ng-click="openRichTextDlg(node, 'text', 'Definition Text', true)" ng-show="node.text !=='' && node.text !==null" class="point">
                    <i class="fa fa-eye fa-fw"></i>
                </a>
            </div>
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <!--<span class="form-control" style="width:100%;height:100%" ng-bind="node.comment" disabled ng-show="node.comment !=null && node.comment !=''">-->
            <!--</span>-->
            <a ng-click="openInputTextDlg(node, 'comment','Comment', true)" class="point"
               ng-show="node.comment !== '' && node.comment !== null"
               tooltip-html="node.comment" tooltip-append-to-body="true"
               tooltip-class="constraints-tooltip"
               tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ng-show="node.comment !== '' && node.comment !== null"></i>
            </a>

        </td>
    </tr>
</script>
<script type="text/ng-template" id="SegmentComponentReadTree.html">
    <tr tt-node is-branch="hasChildren(node)" ng-show="isVisible(node)">
        <td class="col-md-2 col-fixed-250">
            <span>
                                <span ng-show="node.type==='field'" class="label label-field label-icon">F</span>
            <span ng-show="node.type==='component'" class="label label-component label-icon">C</span>
            <span ng-show="node.type==='subcomponent'" class="label label-sub-component label-icon">S</span>
            <span tooltip-html="getComponentNodeName(node)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getComponentNodeName(node)" tooltip-trigger tooltip-animation="false" tooltip-placement="left"></span>
            </span>
        </td>
        <td class="col-md-1 col-fixed-80">
            <span ng-show="node.usage !=='C' || (node.usage==='C' && countPredicateOnComponent(node.position, node.id)===0 )">
                {{::node.usage}}
            </span>
            <div ng-show="node.usage==='C' && countPredicateOnComponent(node.position, node.id) !==0">
                <p ng-repeat="p in parentsMap[node.id].predicates | filter:{constraintTarget:node.position + '[1]'}:true">
                    C({{::p.trueUsage}}/{{::p.falseUsage}})
                </p>
            </div>
        </td>
        <td class="col-md-1 col-fixed-100">
            <div>
                -
            </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.datatype.id].components.length == 0">
                [{{::node.minLength}},{{::node.maxLength}}]
            </div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-class="{'emptyCol':datatypesMap[node.datatype.id].components.length >0}">
            <div ng-show="datatypesMap[node.datatype.id].components.length == 0" ng-bind="node.confLength">
            </div>
        </td>
        <td class="col-md-1 col-fixed-100" ng-show="viewSettings.isVisibleColumn('datatype')">
            <span ng-click="redirectDT(node.datatype)">{{getDatatypeLabel(datatypesMap[node.datatype.id])}}
            </span>
        </td>
        <td class="col-md-1 col-fixed-130" ng-show="viewSettings.isVisibleColumn('valueSet')">
            <a type="button" class="point" ng-show="node.tables !=undefined && node.tables !==null" ng-repeat="table in node.tables" ng-click="redirectVS(table)">{{getTableLabel(tablesMap[table.id])}}
</a>
        </td>
        <td class="col-md-1" ng-style="predWidthx" ng-show="viewSettings.isVisibleColumn('predicate')">
            <div>
                <p ng-repeat="p in parentsMap[node.id].predicates | filter:{constraintTarget:node.position + '[1]'}:true" tooltip-html="getPredicateAsString(p)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getPredicateAsString(p)"
                    tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-1" ng-style="csWidthx" ng-show="viewSettings.isVisibleColumn('confStatement')">
            <div>
                <p ng-repeat="c in parentsMap[node.id].conformanceStatements | filter:{constraintTarget:node.position + '[1]'}:true" tooltip-html="getConformanceStatementAsString(c)" tooltip-append-to-body="true" tooltip-class="constraints-tooltip" ng-bind-html="getConstraintAsId(c)"
                    tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                </p>
            </div>
        </td>
        <td class="col-md-1 col-fixed-80" ng-show="viewSettings.isVisibleColumn('defText')">
            <a ng-show="node.text !=null" ng-click="openRichTextDlg(node, 'text', 'Definition Text', true)" class="point">
                <i class="fa fa-eye fa-fw"></i>
            </a>
        </td>
        <td class="col-md-1" ng-style="commentWidth" ng-show="viewSettings.isVisibleColumn('comment')">
            <!--<span class="form-control" style="width:100%;height:100%" ng-bind="node.comment" ng-show="node.comment !=='' && node.comment !==null" disabled>-->
            <!--</span>-->
            <a ng-click="openInputTextDlg(node, 'comment','Comment', true)" class="point"
               ng-show="node.comment !== '' && node.comment !== null"
               tooltip-html="node.comment" tooltip-append-to-body="true"
               tooltip-class="constraints-tooltip"
               tooltip-trigger tooltip-animation="false" tooltip-placement="left">
                <i class="fa fa-eye fa-fw" ng-show="node.comment !== '' && node.comment !== null"></i>
            </a>

        </td>
    </tr>
</script>
<script type="text/ng-template" id="DynamicMappingCtrl.html">
    <div class="modal-header">
        <h3 class="modal-title">Edit Dynamic Mapping for {{::segment.name}}-{{::selectedNode.position}}</h3>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-md-4">
                First Reference:
            </div>
            <div class="col-md-8">
                <select class="form-control" name="reference" ng-change="recordChange()" ng-model="selectedMapping.reference" ng-options="field.position as segment.name + '-' + field.position + ' : ' + field.name for field in segment.fields" />
            </div>
            <div ng-show="selectedMapping.reference" class="col-md-4">
                Second Reference (Optional):
            </div>
            <div ng-show="selectedMapping.reference" class="col-md-8">
                <select class="form-control" name="secondReference" ng-change="recordChange()" ng-model="selectedMapping.secondReference" ng-options="field.position as segment.name + '-' + field.position + ' : ' + field.name for field in segment.fields" />
            </div>
            <div ng-show="selectedMapping.reference" class="col-md-12">
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr class="tbl-header">
                            <th class="col-md-3">If {{::segment.name}}-{{::selectedMapping.reference}} is</th>
                            <th ng-show="selectedMapping.secondReference" class="col-md-3">And if {{::segment.name}}-{{::selectedMapping.secondReference}} is</th>
                            <th class="col-md-5">Then datatype of {{::segment.name}}-{{::selectedNode.position}} should be</th>
                            <th class="col-md-1">
                                <button title="Add" type="button" class="btn btn-raised btn-xs btn-info" ng-click="addCase()">
                                    <i class="fa fa-plus fa-fw"></i>
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="case in selectedMapping.cases">
                            <td class="col-md-3">
                                <input type="text" class="form-control" ng-model="case.value" ng-change="recordChange()" />
                            </td>
                            <td class="col-md-3">
                                <input type="text" class="form-control" ng-model="case.secondValue" ng-change="recordChange()" />
                            </td>
                            <td class="col-md-5">
                                <select ng-model="case.datatype" class="form-control" ng-change="recordChange()" ng-options="link.id as getDatatypeLabel(datatypesMap[link.id]) for link in igdocument.profile.datatypeLibrary.children | filter: {name: case.value}" />
                            </td>
                            <td class="col-md-1">
                                <button title="Delete" type="button" class="btn btn-raised btn-xs btn-danger" ng-click="deleteCase(case)">
                                    <i class="fa fa-trash-o fa-fw"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button ng-show="changed" type="button" ng-click="updateMapping()" class="btn btn-raised btn-primary btn-sm"><i class="fa fa-check fa-fw">&nbsp; </i>Update
        </button>
        <button ng-show="changed" type="button" ng-click="ok()" class="btn btn-raised btn-warning btn-sm"><i class="fa fa-times fa-fw">&nbsp; </i>Cancel
        </button>
        <button ng-show="!changed" class="btn btn-raised btn-warning btn-sm" ng-click="ok()"><span><i class="fa fa-times fa-fw">
            &nbsp; </i>Cancel</span></button>
    </div>
</script>
<script type="text/ng-template" id="TableMappingSegmentCtrl.html">
    <div class="modal-header">
        <h3 class="modal-title">Bind Value Set to {{::segment.name}}-{{::selectedNode.position}}</h3>
    </div>
    <div class="modal-body">
        <div class="row">
            <form role="form">
                <div class="col-md-6">
                    <h5>List of Tables</h5>
                    <div class="igl-table">
                        <table class="table table-striped table-bordered table-condensed hl7-versions-valueset">
                            <thead>
                                <tr class="tbl-header">
                                    <th data-ng-click="predicate = 'bindingIdentifier'; reverse=!reverse">ID
                                        <i ng-show="reverse && predicate==='bindingIdentifier'" class="fa fa-sort-desc"></i>
                                        <i ng-show="!reverse && predicate==='bindingIdentifier'" class="fa fa-sort-asc"></i>
                                        <i ng-show="predicate!=='bindingIdentifier'" class="fa fa-sort"></i>
                                    </th>
                                    <th data-ng-click="predicate = 'name'; reverse=!reverse">Name
                                        <i ng-show="reverse && predicate==='name'" class="fa fa-sort-desc"></i>
                                        <i ng-show="!reverse && predicate==='name'" class="fa fa-sort-asc"></i>
                                        <i ng-show="predicate!=='name'" class="fa fa-sort"></i>
                                    </th>
                                </tr>
                                <tr>
                                    <th>
                                        <input type="text" class="form-control" placeholder="Search by id" ng-model="searchTableValue.bindingIdentifier" />
                                    </th>
                                    <th>
                                        <input type="text" class="form-control" placeholder="Search by name" ng-model="searchTableValue.name" />
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="table in tables|filter:searchTableValue|orderBy:predicate:reverse">
                                    <td>
                                        <a ng-click="selectTable(table)">{{::table.bindingIdentifier}}</a>
                                    </td>
                                    <td ng-bind-html="table.name"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-md-6">
                    <h5>Selected Table for {{::segment.name}}-{{::selectedNode.position}}</h5>
                    <span ng-show="selectedTable != undefined">
                    <div class="row">
                        <div class="col-sm-2">
                            <p>ID:</p>

                            <p>Extensibility:</p>
                        </div>
                        <div class="col-sm-4">
                            <p>{{::selectedTable.bindingIdentifier}}</p>

                            <p>{{::selectedTable.extensibility}}</p>
                        </div>
                        <div class="col-sm-2">
                            <p>Name:</p>

                            <p>Stability:</p>
                        </div>
                        <div class="col-sm-4">
                            <p>{{::selectedTable.name}}</p>

                            <p>{{::selectedTable.stability}}</p>
                        </div>
                    </div>

                    <h5>List of Codes</h5>
                    
                    <div class="igl-table">
                        <table class="table table-striped table-bordered table-condensed hl7-versions-valueset">
                            <thead>
                            <tr class="tbl-header">
                                <th data-ng-click="predicate = 'value'; reverse=!reverse">Value
                                    <i ng-show="reverse && predicate==='value'" class="fa fa-sort-desc"></i>
                                    <i ng-show="!reverse && predicate==='value'" class="fa fa-sort-asc"></i>
                                    <i ng-show="predicate!=='value'" class="fa fa-sort"></i>
                                </th>
                                <th data-ng-click="predicate = 'label'; reverse=!reverse">Description
                                    <i ng-show="reverse && predicate==='label'" class="fa fa-sort-desc"></i>
                                    <i ng-show="!reverse && predicate==='label'" class="fa fa-sort-asc"></i>
                                    <i ng-show="predicate!=='label'" class="fa fa-sort"></i>
                                </th>
                                <th>Codesys</th>
                                <th>Usage</th>
                            </tr>
                            <tr>
                                <th>
                                    <input type="text" class="form-control" placeholder="Search by value"
                                           ng-model="searchCodeValue.value"/>
                                </th>
                                <th>
                                    <input type="text" class="form-control" placeholder="Search by description"
                                           ng-model="searchCodeValue.label"/>
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="c in selectedTable.codes|filter:searchCodeValue|orderBy:predicate:reverse">
                                <td ng-bind-html="c.value"></td>
                                <td ng-bind-html="c.label"></td>
                                <td ng-bind-html="c.codeSystem"></td>
                                <td ng-bind-html="c.codeUsage"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </span>
                </div>
            </form>
        </div>
    </div>
    <div class="modal-footer">
        <button ng-show="changed" type="button" ng-click="mappingTable()" class="btn btn-raised btn-primary btn-sm"><i class="fa fa-check fa-fw">&nbsp; </i>Bind
        </button>
        <button ng-show="changed" type="button" ng-click="ok()" class="btn btn-raised btn-warning btn-sm"><i class="fa fa-times fa-fw">&nbsp; </i>Cancel
        </button>
        <button ng-show="!changed" class="btn btn-raised btn-warning btn-sm" ng-click="ok()"><span><i class="fa fa-times fa-fw">
            &nbsp; </i>Cancel</span></button>
    </div>
</script>
<script type="text/ng-template" id="ConfirmSegmentDeleteCtrl.html">
    <div class="modal-header">
        <h3 class="modal-title">Delete Confirmation</h3>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to delete Segment {{getSegmentLabel(segToDelete)}} ? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="SegmentReferencesCtrl.html">
    <div class="modal-header">
        <h3 class="modal-title">Segment References Found
            <button class="btn btn-raised btn-primary pull-right" ng-click="ok()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Close</span>
            </button>
        </h3>
    </div>
    <div class="modal-body">
        <p>We cannot delete this segment because it is being referenced by the messages below:</p>
        <div class="igl-table">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr class="tbl-header">
                        <th>Name</th>
                        <th>Path</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="ref in references track by ref.id">
                        <td>
                            <span>

                                            <span ng-show="ref.type === 'group'"
                                                  class="label label-success label-icon">G</span>
                            <span ng-show="ref.type === 'segmentRef'" class="label label-segment label-icon">S</span>
                            <span style="width:60%" name="name" ng-bind="ref.name"></span>
                            <span ng-bind="ref.description"></span>
                            </span>
                        </td>
                        <td>
                            <div>{{::ref.path}}</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</script>
<script type="text/ng-template" id="AddFieldModal.html">
    <div class="modal-header modal-wide">
        <div class="form-inline">
            <span class="header4">Create Field</span>
        </div>
    </div>
    <div class="modal-body">
        <div class="creation-modal-content">
            <form name="addFieldForm" class="form-horizontal" novalidate>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addFieldForm.inputName.$valid}">
                    <label class="col-md-3 control-label">Name*</label>
                    <div class="controls col-md-9">
                        <input name="inputName" id="inputName" class="form-control focus" ng-model="newField.name" autofocus required/>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addFieldForm.inputPosition.$valid}">
                    <label class="col-md-3 control-label">Position*</label>
                    <div class="controls col-md-9">
                        <select ng-model="position" name="inputPosition" id="inputPosition" ng-change="selectPos()" class="form-control input-sm" required>
                            <option ng-repeat="field in segment.fields track by field.id"> {{::field.position}}
                                <option value="{{::segment.fields.length+1}}">{{::segment.fields.length+1}}
                        </select>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addFieldForm.inputUsage.$valid}">
                    <label class="col-md-3 control-label">Usage*</label>
                    <div class="controls col-md-9">
                        <select name="inputUsage" id="inputUsage" class="form-control input-sm" name="inputUsage" ng-change="selectUsage(newField.usage)" ng-model="newField.usage" ng-options="usage for usage in config.usages" required/>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addFieldForm.cardMin.$valid ||!addFieldForm.cardMax.$valid }">
                    <label class="col-md-3 control-label">Cardinality*</label>
                    <div class="controls col-md-9">
                        <div class="form-inline">
                            <input class="form-control" placeholder="Min" name="cardMin" style="width:49%" id="cardMin" ng-change="setDirty()" ng-pattern="/^\d+$/" ng-model="newField.min" ng-disabled="disableMin" required>
                            <input class="form-control" type="text" placeholder="Max" style="width:50%" name="cardMax" id="cardMax" ng-change="setDirty()" ng-pattern="/^\d+$|^\*?$/" ng-model="newField.max" ng-disabled="disableMax" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !selectedDT()}">
                    <label class="col-md-3 control-label">Datatype*</label>
                    <div class="controls col-md-9">
                        <input class="form-control" type="text" ng-model="searchDT.name" ng-hide="selectedDT()" />
                        <li class="form-control" ng-show="selectedDT()">
                            {{DT.name}} <span ng-show="DT.ext">_{{DT.ext}}</span>
                            <button type="button" class="close" aria-label="Close" ng-click="unselectDT()">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </li>
                        <div ng-show="searchDT.name  && !selectedDT()">
                            <li class="form-control" ng-class="{'active':isDTActive(datatype.id)}" ng-click="selectDT(datatype)" ng-repeat="datatype in datatypes | filter:searchDT">
                                {{datatype.name}} <span ng-show="datatype.ext">_{{datatype.ext}}</span>
                            </li>
                        </div>
                    </div>
                </div>
                <div class="form-group control-group" ng-show="selectedDT() && DT.components.length===0">
                    <label class="col-md-3 control-label" ng-class="{'igl-has-error has-feedback': !addFieldForm.minLength.$valid ||!addFieldForm.maxLength.$valid }">Length*</label>
                    <div class="controls col-md-9">
                        <div class="form-inline">
                            <input class="form-control" placeholder="Min Length" name="minLength" style="width:49%" id="minLength" ng-change="setDirty()" ng-pattern="/^\d+$/" ng-model="newField.minLength" required ng-minlength="0">
                            <input class="form-control" type="text" placeholder="Max Length" style="width:50%" name="maxLength" id="maxLength" ng-change="setDirty()" ng-pattern="/^\d+$|^\*?$/" ng-model="newField.maxLength" required>
                        </div>
                    </div>
                </div>
                <div class="form-group control-group" ng-class="{'igl-has-error has-feedback': !addFieldForm.confLength.$valid}" ng-show="selectedDT() && DT.components.length===0">
                    <label class="col-md-3 control-label">Conf Length</label>
                    <div class="controls col-md-9">
                        <input class="form-control" name="confLength" id="confLength" ng-change="setDirty()" ng-pattern="/^\d+$/" ng-model="newField.confLength">
                    </div>
                </div>
                <div class="form-group control-group">
                    <label class="col-md-3 control-label">ValueSet</label>
                    <div class="controls col-md-9">
                        <tags-input ng-model="vs" key-property="id" display-property="bindingIdentifier" placeholder="Select Value Sets" add-from-autocomplete-only="true" replace-spaces-with-dashes="false" on-tag-added="tagAdded($tag)" on-tag-removed="tagRemoved($tag)">
                            <auto-complete source="loadVS($query)" min-length="0" load-on-focus="true" max-results-to-show="10"></auto-complete>
                        </tags-input>
                    </div>
                   
                </div>
                <div class="form-group control-group">
                    <label class="col-md-3 control-label">Comment</label>
                    <div class="controls col-md-9">
                        <textarea class="form-control" ng-model="newField.comment">
                        </textarea>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-raised bt-default btn-md" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
                &nbsp; </i>Cancel</span>
            </button>
            <button class="btn btn-raised btn-info btn-md" ng-click="addField()" ng-disabled="addFieldForm.$invalid || !selectedDT()"><span><i
                    class="fa fa-plus fa-fw">
                &nbsp; </i>Add</span>
            </button>
        </div>
    </div>
</script>
<script type="text/ng-template" id="DeleteField.html">
    <div class="modal-header">
        <h3 class="modal-title">Delete Confirmation</h3>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to delete Field: {{::fieldToDelete.name}} ? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="otherDTModal.html">
    <div class="modal-header">
        <h3 class="modal-title">Select Datatype for {{::field.type}} : {{::field.name}}</h3>
    </div>
    <div class="modal-body">
        <div class="input-group">
            <span class="input-group-addon" id="segment-basic-addon1"><i class="fa fa-search"></i> Search</span>
            <input type="text" class="form-control input-lg" ng-model="newDt" data-animation="am-flip-x" data-auto-select="true" typeahead="datatype as getDtLabel(datatype) for datatype in datatypes|filter:{name:$viewValue} | limitTo:5" placeholder="Search By Name">
        </div>
    </div>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised bt-default btn-md" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
                &nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-info btn-md" ng-click="addDT()" ng-disabled="!isInDts(newDt)"><span><i
                    class="fa fa-check">
                &nbsp; </i>Select</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="editVSModal.html">
    <div class="modal-header">
        <h3 class="modal-title">Select Value Sets for {{::field.type}} : {{::field.name}}</h3>
    </div>
    <div class="modal-body">
        <tags-input ng-model="vs" key-property="id" display-property="bindingIdentifier" placeholder="Select Value Sets" add-from-autocomplete-only="true" replace-spaces-with-dashes="false" on-tag-added="tagAdded($tag)" on-tag-removed="tagRemoved($tag)">
            <auto-complete source="loadVS($query)" min-length="0" load-on-focus="true" max-results-to-show="10"></auto-complete>
        </tags-input>
    </div>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised bt-default btn-md" ng-click="cancel()"><span><i class="fa fa-times fa-fw">
                &nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-info btn-md" ng-click="addVS()" ng-disabled="!vsChanged"><span><i
                    class="fa fa-check">
                &nbsp; </i>Select</span>
        </button>
    </div>
</script>
<script type="text/ng-template" id="DeleteSegmentPredicate.html">
    <div class="modal-header">
        <h3 class="modal-title">Delete Confirmation</h3>
    </div>
    <div class="modal-body">
        <p>Are you sure you want to delete the predicate? </p>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-danger btn-sm" ng-click="delete()"><span><i class="fa fa-trash-o fa-fw">&nbsp; </i>Delete</span>
        </button>
    </div>
</script>

<script type="text/ng-template" id="AddBindingForSegment.html">
    <div class="modal-header">
        <h3 class="modal-title">Add Binding for Segment : {{::getSegmentLabel(segment)}}</h3>
    </div>
    <div class="modal-body">
        <table class="table table-striped table-bordered table-condensed">
            <thead>
            <tr class="tbl-header">
                <th class="col-md-4">Message</th>
                <th class="col-md-8">SegmentRef</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="col-md-4">
                    <select ng-model='selectedMessageForBinding' class="form-control" ng-change="selectMessage();" ng-options="msg as msg.name + '-' + msg.identifier for msg in messages.children" />
                </td>
                <td class="col-md-8">
                    <select ng-show='selectedMessageForBinding != null' ng-model='selectedSegRefForBinding' class="form-control">
                        <option ng-repeat="ref in segRefsList" value="{{ref}}" ng-disabled="checkDuplicated(ref.positionPath);">
                            {{::ref.path}}({{::ref.positionPath}})
                        </option>
                    </select>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-raised btn-default btn-sm" ng-click="cancel()"><span><i class="fa fa-times fa-fw">&nbsp; </i>Cancel</span>
        </button>
        <button class="btn btn-raised btn-info btn-sm" ng-disabled="selectedSegRefForBinding == null" ng-click="save()"><span><i class="fa fa-plus fa-fw">&nbsp; </i>ADD</span>
        </button>
    </div>
</script>